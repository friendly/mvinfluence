[{"path":"http://friendly.github.io/mvinfluence/articles/uni-vs-multi.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Load packages","title":"Univariate versus Multivariate Influence","text":"","code":"library(tibble)      # Simple Data Frames library(ggplot2)     # Create Elegant Data Visualisations Using the Grammar of Graphics library(car)         # Companion to Applied Regression library(mvinfluence) # Influence Measures and Diagnostic Plots for Multivariate Linear Models library(patchwork)   # The Composer of Plots library(rgl)         # 3D Visualization Using OpenGL rgl::setupKnitr(autoprint = TRUE)"},{"path":"http://friendly.github.io/mvinfluence/articles/uni-vs-multi.html","id":"a-toy-example","dir":"Articles","previous_headings":"","what":"A Toy Example","title":"Univariate versus Multivariate Influence","text":"example, Barrett (2003), considers simplest case, one predictor (x) two response variables, y1 y2. quick peek data indicates y1 y2 nearly perfectly correlated. linear x one extreme point (case 9). Looking pairwise plots doesn’t suggest anything terribly wrong.  can view data 3D, using car::scatter3d(). regression plane shown model y1 ~ y2 + x. plot interactive: can rotate zoom using mouse see views shown scatterplots. rotate plot regression plane becomes line, can see data ellipsoid essentially flat.","code":"Toy <- tibble(    case = 1:9,    x =  c(1,    1,    2,    2,    3,    3,    4,    4,    10),    y1 = c(0.10, 1.90, 1.00, 2.95, 2.10, 4.00, 2.95, 4.95, 10.00),    y2 = c(0.10, 1.80, 1.00, 2.93, 2.00, 4.10, 3.05, 4.93, 10.00) ) car::scatterplotMatrix(~y1 + y2 + x, data=Toy, cex=2,         col = \"blue\", pch = 16,         id = list(n=1, cex=2),          regLine = list(lwd = 2, col=\"red\"),         smooth = FALSE) car::scatter3d(y1 ~ y2 + x, data=Toy,                ellipsoid = TRUE,              # show the data ellipsoid                radius = c(rep(1,8), 2),       # make case 9 larger                grid.col = \"pink\", grid.lines = 10,                 fill = FALSE,                id = list(n=1), offset=2                ) rgl::rglwidget()"},{"path":"http://friendly.github.io/mvinfluence/articles/uni-vs-multi.html","id":"models","dir":"Articles","previous_headings":"","what":"Models","title":"Univariate versus Multivariate Influence","text":"fit univariate models y1 y2 separately multivariate model.","code":"Toy.lm1 <- lm(y1 ~ x, data=Toy) Toy.lm2 <- lm(y2 ~ x, data=Toy) Toy.mlm <- lm(cbind(y1, y2) ~ x, data=Toy)"},{"path":"http://friendly.github.io/mvinfluence/articles/uni-vs-multi.html","id":"cooks-d","dir":"Articles","previous_headings":"Models","what":"Cook’s D","title":"Univariate versus Multivariate Influence","text":"First, let’s examine Cook’s D statistics models. Note function cooks.distance() invokes stats::cooks.distance.lm() univariate response models, invokes mvinfluence::cooks.distance.mlm() multivariate model. thing remarkable case 9: univariate Cook’s Ds, D1 D2 small, yet multivariate statistic, D12 10 times next smallest value. can see case 9 stands influence plots. extreme hat value, , ’s residual small, much influence fitted models either y1 y2. Neither plots suggest anything terribly wrong univariate models.  Contrast results get model y1 y2 jointly. multivariate version, influencePlot.mlm plots squared studentized residual (denoted Q output) hat value. Case 9 stands wildly influential.  alternative form multivariate influence plot uses leverage (L) residual (R) components. influence product leverage residual, plot \\(\\log(L)\\) versus \\(\\log(R)\\) attractive property contours constant Cook’s distance fall diagonal lines slope = -1. Adjacent reference lines represent constant multiples influence.","code":"df <- Toy df$D1  <- cooks.distance(Toy.lm1) df$D2  <- cooks.distance(Toy.lm2) df$D12 <- cooks.distance(Toy.mlm)  df #> # A tibble: 9 x 7 #>    case     x    y1    y2      D1      D2    D12 #>   <int> <dbl> <dbl> <dbl>   <dbl>   <dbl>  <dbl> #> 1     1     1  0.1   0.1  0.121   0.118   0.125  #> 2     2     1  1.9   1.8  0.124   0.103   0.298  #> 3     3     2  1     1    0.0901  0.0886  0.0906 #> 4     4     2  2.95  2.93 0.0829  0.0819  0.0831 #> 5     5     3  2.1   2    0.0548  0.0673  0.182  #> 6     6     3  4     4.1  0.0692  0.0852  0.232  #> 7     7     4  2.95  3.05 0.0793  0.0651  0.203  #> 8     8     4  4.95  4.93 0.0665  0.0643  0.0690 #> 9     9    10 10    10    0.00159 0.00830 3.22 ip1 <- car::influencePlot(Toy.lm1, id=list(cex=1.5)) ip2 <- car::influencePlot(Toy.lm2, id=list(cex=1.5)) par(mar = c(4,4,1,1)+.1) influencePlot(Toy.mlm, id.n=2) #>        H      Q  CookD      L      R #> 1 0.2019 0.1769 0.1250 0.2529 0.2216 #> 2 0.2019 0.4219 0.2981 0.2529 0.5286 #> 6 0.1130 0.5873 0.2322 0.1273 0.6621 #> 9 0.8519 1.0816 3.2249 5.7500 7.3010 par(mar = c(4,4,1,1)+.1) influencePlot(Toy.mlm, id.n=2, type = 'LR')"},{"path":"http://friendly.github.io/mvinfluence/articles/uni-vs-multi.html","id":"dfbetas","dir":"Articles","previous_headings":"Models","what":"DFBETAS","title":"Univariate versus Multivariate Influence","text":"DFBETAS statistics give estimated change regression coefficients case deleted turn. can gain insight case 9 unremarkable univariate regressions plotting . values come stats::dfbetas return standardized values.  values case 9 nearly (0, 0) plots, indicating deleting case negligible effect univariate regressions.","code":"db1 <- as.data.frame(dfbetas(Toy.lm1)) gg1 <- ggplot(data = db1, aes(x=`(Intercept)`, y=x, label=rownames(db1))) +   geom_point(size=1.5) +   geom_label(size=6, fill=\"pink\") +   xlab(expression(paste(\"Deletion Intercept  \", b[0]))) +   ylab(expression(paste(\"Deletion Slope  \", b[1]))) +   ggtitle(\"dfbetas for y1\") +   theme_bw(base_size = 16)  db2 <- as.data.frame(dfbetas(Toy.lm2)) gg2 <- ggplot(data = db2, aes(x=`(Intercept)`, y=x, label=rownames(db2))) +   geom_point(size=1.5) +   geom_label(size=6, fill=\"pink\") +   xlab(expression(paste(\"Deletion Intercept  \", b[0]))) +   ylab(expression(paste(\"Deletion Slope  \", b[1]))) +   ggtitle(\"dfbetas for y2\") +   theme_bw(base_size = 16)  gg1 + gg2"},{"path":"http://friendly.github.io/mvinfluence/articles/uni-vs-multi.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Univariate versus Multivariate Influence","text":"Barrett, B. E. Ling, R. F. (1992). General Classes Influence Measures Multivariate Regression. Journal American Statistical Association, 87(417), 184-191. Barrett, B. E. (2003). Understanding Influence Multivariate Regression. Communications Statistics – Theory Methods, 32, 3, 667-680. Belsley, D. ., Kuh, E. Welsch, R. E. (1980). Regression Diagnostics. New York: Wiley. Cook, R. D. Weisberg, S. (1982). Residuals Influence Regression. London: Chapman Hall. Lawrence, . J. (1995). Deletion Influence Masking Regression. Journal Royal Statistical Society. Series B (Methodological) , 57, . 1, pp. 181-189.","code":""},{"path":"http://friendly.github.io/mvinfluence/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael Friendly. Author, maintainer.","code":""},{"path":"http://friendly.github.io/mvinfluence/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Friendly M (2022). mvinfluence: Influence Measures Diagnostic Plots Multivariate Linear Models. R package version 0.9.0, https://github.com/friendly/mvinfluence.","code":"@Manual{,   title = {mvinfluence: Influence Measures and Diagnostic Plots for Multivariate Linear Models},   author = {Michael Friendly},   year = {2022},   note = {R package version 0.9.0},   url = {https://github.com/friendly/mvinfluence}, }"},{"path":"http://friendly.github.io/mvinfluence/index.html","id":"mvinfluence-","dir":"","previous_headings":"","what":"Influence Measures and Diagnostic Plots for Multivariate Linear Models","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models","text":"Influence Measures Diagnostic Plots Multivariate Linear Models Version 0.9-0 Functions package compute regression deletion diagnostics multivariate linear models following methods proposed Barrett & Ling (1992) provide associated diagnostic plots. diagnostic measures include hat-values (leverages), generalized Cook’s distance, generalized squared ‘studentized’ residuals. Several types plots detect influential observations provided. addition, functions provide diagnostics deletion subsets observations size m>1. case theoretically interesting sometimes pairs (m=2) influential observations can mask , sometimes can joint influence far exceeding individual effects, well interesting phenomena described Lawrence (1995). Associated methods case m>1 still development package.","code":""},{"path":"http://friendly.github.io/mvinfluence/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models","text":"Documentation package now available https://friendly.github.io/mvinfluence/.","code":""},{"path":"http://friendly.github.io/mvinfluence/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models","text":"Get released CRAN version development version:","code":""},{"path":"http://friendly.github.io/mvinfluence/index.html","id":"goals","dir":"","previous_headings":"","what":"Goals","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models","text":"design goal package , extension standard methods univariate linear models, able fit linear model multivariate response, get useful diagnostics plots : done comparable univariate functions car package, noteworthy points identified printed output graphs.","code":"mymlm <- lm( cbind(y1, y2, y3) ~ x1 + x2 + x3, data=mydata) influence(mymlm) hatvalues(mymlm) cooks.distance(mymlm) influencePlot(mymlm, ...)"},{"path":"http://friendly.github.io/mvinfluence/index.html","id":"examples","dir":"","previous_headings":"","what":"Examples","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models","text":"Rohwer data contains data kindergarten children designed examine well performance set paired-associate (PA) learning tasks can predict performance measures aptitude achievement— SAT (scholastic aptitude test), PPVT (Peabody Picture Vocabulary Test), Raven ( Raven Progressive Matrices Test). PA tasks differ stimulus item presented: n (named), s (still), ns (named still), na (named action) ss (sentence still). , fit MLM subset Rohwer data (Low SES group).","code":"data(Rohwer, package=\"heplots\") Rohwer2 <- subset(Rohwer, subset=group==2) rownames(Rohwer2)<- 1:nrow(Rohwer2) Rohwer.mod <- lm(cbind(SAT, PPVT, Raven) ~ n + s + ns + na + ss, data=Rohwer2)  car::Anova(Rohwer.mod) #>  #> Type II MANOVA Tests: Pillai test statistic #>    Df test stat approx F num Df den Df Pr(>F)    #> n   1     0.202     2.02      3     24 0.1376    #> s   1     0.310     3.59      3     24 0.0284 *  #> ns  1     0.358     4.46      3     24 0.0126 *  #> na  1     0.465     6.96      3     24 0.0016 ** #> ss  1     0.089     0.78      3     24 0.5173    #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"http://friendly.github.io/mvinfluence/index.html","id":"influence-plots","dir":"","previous_headings":"Examples","what":"Influence plots","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models","text":"default influence plot (type=\"stres\") shows squared standardized residual Hat value. areas circles representing observations proportional generalized Cook’s distances.  can see , function returns data frame influence statistics identified points. “Noteworthy” points unusual either Hat value (H) squared studentized residual (Q), points shown id.n value. often useful sort descending order one influence measures. alternative (type=\"LR\") plots residual components leverage components, log scales. influence product residual × Leverage, plot property contours constant Cook’s distance fall diagonal lines slope = -1. successive dashed line represents multiple Cook’s D. plot often easier read standard version.  observe case 5 largest leverage highly influential. Case 25 largest residual component middling leverage, moderately influential. Cases 14, 29, 27 nearly identical residuals, influence increases left right leverage.","code":"(infl <-influencePlot(Rohwer.mod, id.n=4, type = \"stres\")) #>        H      Q  CookD     L      R #> 5  0.568 0.3439 0.8467 1.316 0.7964 #> 10 0.452 0.0324 0.0634 0.824 0.0591 #> 14 0.126 0.2997 0.1643 0.145 0.3431 #> 15 0.332 0.0105 0.0152 0.498 0.0158 #> 25 0.157 0.3820 0.2601 0.186 0.4532 #> 27 0.367 0.2128 0.3387 0.580 0.3363 #> 29 0.304 0.2295 0.3026 0.437 0.3299 infl |> dplyr::arrange(desc(H)) #>        H      Q  CookD     L      R #> 5  0.568 0.3439 0.8467 1.316 0.7964 #> 10 0.452 0.0324 0.0634 0.824 0.0591 #> 27 0.367 0.2128 0.3387 0.580 0.3363 #> 15 0.332 0.0105 0.0152 0.498 0.0158 #> 29 0.304 0.2295 0.3026 0.437 0.3299 #> 25 0.157 0.3820 0.2601 0.186 0.4532 #> 14 0.126 0.2997 0.1643 0.145 0.3431 influencePlot(Rohwer.mod, id.n=4, type=\"LR\") #>        H      Q  CookD     L      R #> 5  0.568 0.3439 0.8467 1.316 0.7964 #> 10 0.452 0.0324 0.0634 0.824 0.0591 #> 14 0.126 0.2997 0.1643 0.145 0.3431 #> 15 0.332 0.0105 0.0152 0.498 0.0158 #> 25 0.157 0.3820 0.2601 0.186 0.4532 #> 27 0.367 0.2128 0.3387 0.580 0.3363 #> 29 0.304 0.2295 0.3026 0.437 0.3299"},{"path":"http://friendly.github.io/mvinfluence/index.html","id":"index-plots","dir":"","previous_headings":"Examples","what":"Index plots","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models","text":"wish see observations fare measures (well Mahalanobis D2 residuals origin), inflIndexPlot() function gives index plots.  example, note case 5 stands influential, exceptionally large Mahalanobis squared distance, D2 residuals.","code":"infIndexPlot(Rohwer.mod, id.n=3, id.col = \"red\", id.cex=1.5, id.location=\"ab\")"},{"path":"http://friendly.github.io/mvinfluence/index.html","id":"robust-mlms","dir":"","previous_headings":"","what":"Robust MLMs","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models","text":"Influential cases large residuals can sometimes dealt fitting robust version multivariate model. function heplots::robmlm() uses simple M-estimator -weights cases large residuals. Fitting done iterated re-weighted least squares (IWLS), using weights based Mahalanobis squared distances current residuals origin, scaling (covariance) matrix calculated MASS:cov.trob(). returned object weights component, weight case final iteration. ones less 0.9 ? simple index plot makes -weighted observations stand . Case 5 among , label anyway.  ’s case 5? largest leverage, ’s Mahalanobis D2 large. Thus, -weighted, even though influential observation. difference observations make fitted regression? calculates percentage relative difference coefficients standard lm() robust version. largest changes coefficients ss task, even greater one PPVT n task.","code":"Rohwer.rmod <- heplots::robmlm(cbind(SAT, PPVT, Raven) ~ n + s + ns + na + ss, data=Rohwer2) which(Rohwer.rmod$weights < .9) #> [1] 14 21 25 31 par(mar = c(4,4,1,1)+.1) wts <- Rohwer.rmod$weights idx <- c(5, which(wts < .9)) plot(wts, type=\"h\",      xlab = \"Case index\",       ylab = \"Robust mlm weight\",      cex.lab = 1.25) rect(0, .9, 33, 1.1,       col=scales::alpha(\"gray\", .25),       border=NA) points(wts, pch = 16,         cex = ifelse(wts < .9, 1.5, 1),        col = ifelse(wts < .9, \"red\", \"black\")) text(idx, wts[idx], label=idx, pos=3, cex=1.2, xpd=NA ) 100 * abs(coef(Rohwer.mod) - coef(Rohwer.rmod)) / abs(coef(Rohwer.mod)) #>                SAT  PPVT  Raven #> (Intercept)  1.001  1.27  0.755 #> n            4.001 36.32  3.874 #> s            1.195 13.01  0.401 #> ns           0.152 15.68 14.771 #> na           1.560  2.26  6.913 #> ss          15.173 26.55 21.288"},{"path":"http://friendly.github.io/mvinfluence/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models","text":"cite mvinfluence publications, use:","code":"citation(\"mvinfluence\") #>  #> To cite package 'mvinfluence' in publications use: #>  #>   Friendly M (2022). _mvinfluence: Influence Measures and Diagnostic #>   Plots for Multivariate Linear Models_. R package version 0.9.0, #>   <https://github.com/friendly/mvinfluence>. #>  #> A BibTeX entry for LaTeX users is #>  #>   @Manual{, #>     title = {mvinfluence: Influence Measures and Diagnostic Plots for Multivariate Linear Models}, #>     author = {Michael Friendly}, #>     year = {2022}, #>     note = {R package version 0.9.0}, #>     url = {https://github.com/friendly/mvinfluence}, #>   }"},{"path":"http://friendly.github.io/mvinfluence/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models","text":"Barrett, B. E. Ling, R. F. (1992). General Classes Influence Measures Multivariate Regression. Journal American Statistical Association, 87(417), 184-191. Barrett, B. E. (2003). Understanding Influence Multivariate Regression. Communications Statistics – Theory Methods, 32, 3, 667-680. Lawrence, . J. (1995). Deletion Influence Masking Regression. Journal Royal Statistical Society. Series B (Methodological) , 57, . 1, pp. 181-189.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/as.data.frame.inflmlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert an inflmlm object to a data frame — as.data.frame.inflmlm","title":"Convert an inflmlm object to a data frame — as.data.frame.inflmlm","text":"function used internally package convert result mlm.influence() data frame. normally called user.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/as.data.frame.inflmlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert an inflmlm object to a data frame — as.data.frame.inflmlm","text":"","code":"# S3 method for inflmlm as.data.frame(x, ..., FUN = det, funnames = TRUE)"},{"path":"http://friendly.github.io/mvinfluence/reference/as.data.frame.inflmlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert an inflmlm object to a data frame — as.data.frame.inflmlm","text":"x inflmlm object, returned mlm.influence ... ignored FUN case subset size, m>1, function used H, Q, L, R calculate single statistic. default det. alternative tr, matrix trace. funnames logical. FUN name prepended statistics creating data frame?","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/as.data.frame.inflmlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert an inflmlm object to a data frame — as.data.frame.inflmlm","text":"data frame containing influence statistics","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/as.data.frame.inflmlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert an inflmlm object to a data frame — as.data.frame.inflmlm","text":"","code":"# none"},{"path":"http://friendly.github.io/mvinfluence/reference/cooks.distance.mlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Cook's distance for a MLM — cooks.distance.mlm","title":"Cook's distance for a MLM — cooks.distance.mlm","text":"functions cooks.distance.mlm hatvalues.mlm designed extractor functions regression deletion diagnostics multivariate linear models following Barrett & Ling (1992). close analogs methods univariate generalized linear models handled influence.measures stats package.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/cooks.distance.mlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cook's distance for a MLM — cooks.distance.mlm","text":"","code":"# S3 method for mlm cooks.distance(model, infl = mlm.influence(model, do.coef = FALSE), ...)"},{"path":"http://friendly.github.io/mvinfluence/reference/cooks.distance.mlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cook's distance for a MLM — cooks.distance.mlm","text":"model mlm object, fit lm() infl inflmlm object. default simply runs mlm.influence() model, suppressing coefficients. ... Ignored","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/cooks.distance.mlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cook's distance for a MLM — cooks.distance.mlm","text":"vector Cook's distances","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/cooks.distance.mlm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cook's distance for a MLM — cooks.distance.mlm","text":"addition, functions provide diagnostics deletion subsets observations size m>1.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/cooks.distance.mlm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cook's distance for a MLM — cooks.distance.mlm","text":"Barrett, B. E. Ling, R. F. (1992). General Classes Influence Measures Multivariate Regression. Journal American Statistical Association, 87(417), 184-191.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/cooks.distance.mlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cook's distance for a MLM — cooks.distance.mlm","text":"","code":"data(Rohwer, package=\"heplots\") Rohwer2 <- subset(Rohwer, subset=group==2) rownames(Rohwer2)<- 1:nrow(Rohwer2) Rohwer.mod <- lm(cbind(SAT, PPVT, Raven) ~ n+s+ns+na+ss, data=Rohwer2)  hatvalues(Rohwer.mod) #>          1          2          3          4          5          6          7  #> 0.16700926 0.21845327 0.14173469 0.07314341 0.56821462 0.15432157 0.04530969  #>          8          9         10         11         12         13         14  #> 0.17661104 0.05131298 0.45161152 0.14542776 0.17050399 0.10374592 0.12649927  #>         15         16         17         18         19         20         21  #> 0.33246744 0.33183461 0.17320579 0.26353864 0.29835817 0.07880597 0.14023750  #>         22         23         24         25         26         27         28  #> 0.19380286 0.04455330 0.20641708 0.15712604 0.15333879 0.36726467 0.11189754  #>         29         30         31         32  #> 0.30426999 0.08655434 0.08921878 0.07320950  cooks.distance(Rohwer.mod) #>           1           2           3           4           5           6  #> 0.110668789 0.035758983 0.074110633 0.006454502 0.846717339 0.014584590  #>           7           8           9          10          11          12  #> 0.025295531 0.147676200 0.040403408 0.063391985 0.045680183 0.116293594  #>          13          14          15          16          17          18  #> 0.042671229 0.164273594 0.015190817 0.118323491 0.144482540 0.056707069  #>          19          20          21          22          23          24  #> 0.173206386 0.037332773 0.151642786 0.040245143 0.030356681 0.072943655  #>          25          26          27          28          29          30  #> 0.260083518 0.042608984 0.338661595 0.034223968 0.302596343 0.045051960  #>          31          32  #> 0.097583942 0.055032090"},{"path":"http://friendly.github.io/mvinfluence/reference/Fertilizer.html","id":null,"dir":"Reference","previous_headings":"","what":"Fertilizer Data — Fertilizer","title":"Fertilizer Data — Fertilizer","text":"small data set use fertilizer (x) relation amount grain (y1) straw (y2) produced.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/Fertilizer.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Fertilizer Data — Fertilizer","text":"data frame 8 observations following 3 variables. grain amount grain produced straw amount straw produced fertilizer amount fertilizer applied","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/Fertilizer.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Fertilizer Data — Fertilizer","text":"Anderson, T. W. (1984). Introduction Multivariate     Statistical Analysis, New York: Wiley, p. 369.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/Fertilizer.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fertilizer Data — Fertilizer","text":"first observation obvious outlier influential observation.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/Fertilizer.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fertilizer Data — Fertilizer","text":"Hossain, . Naik, D. N. (1989). Detection influential     observations multivariate regression.      Journal Applied  Statistics, 16 (1), 25-37.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/Fertilizer.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fertilizer Data — Fertilizer","text":"","code":"data(Fertilizer)  # simple plots plot(Fertilizer, col=c('red', rep(\"blue\",7)),       cex=c(2,rep(1.2,7)),       pch=as.character(1:8))   # A biplot shows the data in 2D. It gives another view of how case 1 stands out in data space biplot(prcomp(Fertilizer))   # fit the mlm mod <- lm(cbind(grain, straw) ~ fertilizer, data=Fertilizer) Anova(mod) #>  #> Type II MANOVA Tests: Pillai test statistic #>            Df test stat approx F num Df den Df    Pr(>F)     #> fertilizer  1   0.94119    40.01      2      5 0.0008388 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # influence plots (m=1) influencePlot(mod)  #>           H        Q    CookD        L        R #> 1 0.6203523 1.853289 3.449076 1.634021 4.881602 influencePlot(mod, type='LR')  #>           H        Q    CookD        L        R #> 1 0.6203523 1.853289 3.449076 1.634021 4.881602 influencePlot(mod, type='stres')  #>           H        Q    CookD        L        R #> 1 0.6203523 1.853289 3.449076 1.634021 4.881602"},{"path":"http://friendly.github.io/mvinfluence/reference/hatvalues.mlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Hatvalues for a MLM — hatvalues.mlm","title":"Hatvalues for a MLM — hatvalues.mlm","text":"functions cooks.distance.mlm hatvalues.mlm designed extractor functions regression deletion diagnostics multivariate linear models following Barrett & Ling (1992). close analogs methods univariate generalized linear models handled influence.measures stats package.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/hatvalues.mlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hatvalues for a MLM — hatvalues.mlm","text":"","code":"# S3 method for mlm hatvalues(model, m = 1, infl, ...)"},{"path":"http://friendly.github.io/mvinfluence/reference/hatvalues.mlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hatvalues for a MLM — hatvalues.mlm","text":"model object class mlm, returned lm m size subsets considered infl inflmlm object, returned mlm.influence ... arguments, compatibility generic; ignored.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/hatvalues.mlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hatvalues for a MLM — hatvalues.mlm","text":"vector hatvalues","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/hatvalues.mlm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hatvalues for a MLM — hatvalues.mlm","text":"Hat values component influence diagnostics, measuring leverage  outlyingness observations space predictor variables. usual case considers observations one time (m=1), hatvalue  proportional squared Mahalanobis distance, \\(D^2\\) observation centroid observations. function extends definition calculate comparable quantity subsets size m>1.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/hatvalues.mlm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hatvalues for a MLM — hatvalues.mlm","text":"Barrett, B. E. Ling, R. F. (1992). General Classes Influence Measures Multivariate Regression. Journal American Statistical Association, 87(417), 184-191.","code":""},{"path":[]},{"path":"http://friendly.github.io/mvinfluence/reference/hatvalues.mlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hatvalues for a MLM — hatvalues.mlm","text":"","code":"data(Rohwer, package=\"heplots\") Rohwer2 <- subset(Rohwer, subset=group==2) rownames(Rohwer2)<- 1:nrow(Rohwer2) Rohwer.mod <- lm(cbind(SAT, PPVT, Raven) ~ n+s+ns+na+ss, data=Rohwer2)  options(digits=3) hatvalues(Rohwer.mod) #>      1      2      3      4      5      6      7      8      9     10     11  #> 0.1670 0.2185 0.1417 0.0731 0.5682 0.1543 0.0453 0.1766 0.0513 0.4516 0.1454  #>     12     13     14     15     16     17     18     19     20     21     22  #> 0.1705 0.1037 0.1265 0.3325 0.3318 0.1732 0.2635 0.2984 0.0788 0.1402 0.1938  #>     23     24     25     26     27     28     29     30     31     32  #> 0.0446 0.2064 0.1571 0.1533 0.3673 0.1119 0.3043 0.0866 0.0892 0.0732  cooks.distance(Rohwer.mod) #>       1       2       3       4       5       6       7       8       9      10  #> 0.11067 0.03576 0.07411 0.00645 0.84672 0.01458 0.02530 0.14768 0.04040 0.06339  #>      11      12      13      14      15      16      17      18      19      20  #> 0.04568 0.11629 0.04267 0.16427 0.01519 0.11832 0.14448 0.05671 0.17321 0.03733  #>      21      22      23      24      25      26      27      28      29      30  #> 0.15164 0.04025 0.03036 0.07294 0.26008 0.04261 0.33866 0.03422 0.30260 0.04505  #>      31      32  #> 0.09758 0.05503"},{"path":"http://friendly.github.io/mvinfluence/reference/infIndexPlot.mlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Influence Index Plots for Multivariate Linear Models — infIndexPlot.mlm","title":"Influence Index Plots for Multivariate Linear Models — infIndexPlot.mlm","text":"Provides index plots diagnostic measures multivariate linear model: Cook's distance, generalized (squared) studentized residual, hat-values (leverages), Mahalanobis squared distances residuals.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/infIndexPlot.mlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Influence Index Plots for Multivariate Linear Models — infIndexPlot.mlm","text":"","code":"# S3 method for mlm infIndexPlot(   model,   infl = mlm.influence(model, do.coef = FALSE),   FUN = det,   vars = c(\"Cook\", \"Studentized\", \"hat\", \"DSQ\"),   main = paste(\"Diagnostic Plots for\", deparse(substitute(model))),   pch = 19,   labels,   id.method = \"y\",   id.n = if (id.method[1] == \"identify\") Inf else 0,   id.cex = 1,   id.col = palette()[1],   id.location = \"lr\",   grid = TRUE,   ... )"},{"path":"http://friendly.github.io/mvinfluence/reference/infIndexPlot.mlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Influence Index Plots for Multivariate Linear Models — infIndexPlot.mlm","text":"model multivariate linear model object class mlm . infl influence measure structure returned mlm.influence FUN m>1, function applied \\(H\\) \\(Q\\) matrices returning scalar value.  FUN=det FUN=tr possible choices, returning \\(|H|\\) \\(tr(H)\\) respectively. vars quantities listed argument plotted.  Use \"Cook\" generalized Cook's distances, \"Studentized\" generalized Studentized residuals, \"hat\" hat-values (leverages), DSQ squared Mahalanobis distances model residuals.  Capitalization optional. may abbreviated first one letters. main main title graph pch Plotting character points id.method, labels, id.n, id.cex, id.col, id.location Arguments labeling points.  default id.n=0 labeling points. See showLabels details arguments. grid TRUE, default, light-gray background grid put graph ... Arguments passed plot","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/infIndexPlot.mlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Influence Index Plots for Multivariate Linear Models — infIndexPlot.mlm","text":"None. Used side effect producing graph.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/infIndexPlot.mlm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Influence Index Plots for Multivariate Linear Models — infIndexPlot.mlm","text":"function produces index plots various influence measures calculated influence.mlm, addition, measure based Mahalanobis squared distances residuals origin.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/infIndexPlot.mlm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Influence Index Plots for Multivariate Linear Models — infIndexPlot.mlm","text":"Barrett, B. E. Ling, R. F. (1992). General Classes Influence Measures Multivariate Regression. Journal American Statistical Association, 87(417), 184-191. Barrett, B. E. (2003). Understanding Influence Multivariate Regression Communications Statistics - Theory Methods, 32, 667-680.","code":""},{"path":[]},{"path":"http://friendly.github.io/mvinfluence/reference/infIndexPlot.mlm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Influence Index Plots for Multivariate Linear Models — infIndexPlot.mlm","text":"Michael Friendly; borrows code car::infIndexPlot","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/infIndexPlot.mlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Influence Index Plots for Multivariate Linear Models — infIndexPlot.mlm","text":"","code":"# iris data data(iris) iris.mod <- lm(as.matrix(iris[,1:4]) ~ Species, data=iris) infIndexPlot(iris.mod, col=iris$Species, id.n=3)   # Sake data data(Sake, package=\"heplots\") Sake.mod <- lm(cbind(taste,smell) ~ ., data=Sake) infIndexPlot(Sake.mod, id.n=3)   # Rohwer data data(Rohwer, package=\"heplots\") Rohwer2 <- subset(Rohwer, subset=group==2) rownames(Rohwer2)<- 1:nrow(Rohwer2) rohwer.mlm <- lm(cbind(SAT, PPVT, Raven) ~ n + s + ns + na + ss, data=Rohwer2) infIndexPlot(rohwer.mlm, id.n=3)"},{"path":"http://friendly.github.io/mvinfluence/reference/influence.mlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Regression Deletion Diagnostics for Multivariate Linear Models — influence.mlm","title":"Regression Deletion Diagnostics for Multivariate Linear Models — influence.mlm","text":"collection functions designed compute regression deletion diagnostics multivariate linear models following Barrett & Ling (1992) close analogs methods univariate generalized linear models handled influence.measures stats package.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/influence.mlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regression Deletion Diagnostics for Multivariate Linear Models — influence.mlm","text":"","code":"# S3 method for mlm influence(model, do.coef = TRUE, m = 1, ...)"},{"path":"http://friendly.github.io/mvinfluence/reference/influence.mlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regression Deletion Diagnostics for Multivariate Linear Models — influence.mlm","text":"model mlm object, returned lm .coef logical. coefficients returned inflmlm object? m Size subsets deletion diagnostics ... arguments passed methods","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/influence.mlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regression Deletion Diagnostics for Multivariate Linear Models — influence.mlm","text":"influence.mlm returns S3 object class inflmlm, list following components m Deletion subset size H Hat values, \\(H_I\\). m=1, vector              diagonal entries ‘hat’ matrix.  Otherwise, list               \\(m \\times m\\) matrices corresponding subsets. Q Residuals, \\(Q_I\\). CookD Cook's distance values L Leverage components R Residual components subsets Indices observations subsets size m labels Observation labels call Model call mlm object Beta Deletion regression coefficients-- included ifdo.coef=TRUE","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/influence.mlm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Regression Deletion Diagnostics for Multivariate Linear Models — influence.mlm","text":"addition, functions provide diagnostics deletion subsets observations size m>1. influence.mlm simple wrapper computational function, mlm.influence designed provide S3 method class \"mlm\" objects. still infelicities methods m>1 case current implementation. particular, m>1, must call influence.mlm directly, rather using S3 generic influence().","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/influence.mlm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Regression Deletion Diagnostics for Multivariate Linear Models — influence.mlm","text":"Barrett, B. E. Ling, R. F. (1992). General Classes Influence Measures Multivariate Regression. Journal American Statistical Association, 87(417), 184-191.","code":""},{"path":[]},{"path":"http://friendly.github.io/mvinfluence/reference/influence.mlm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Regression Deletion Diagnostics for Multivariate Linear Models — influence.mlm","text":"Michael Friendly","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/influence.mlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Regression Deletion Diagnostics for Multivariate Linear Models — influence.mlm","text":"","code":"# Rohwer data data(Rohwer, package=\"heplots\") Rohwer2 <- subset(Rohwer, subset=group==2) rownames(Rohwer2)<- 1:nrow(Rohwer2) Rohwer.mod <- lm(cbind(SAT, PPVT, Raven) ~ n+s+ns+na+ss, data=Rohwer2)  # m=1 diagnostics influence(Rohwer.mod) |> head() #> $m #> [1] 1 #>  #> $H #>  [1] 0.1670 0.2185 0.1417 0.0731 0.5682 0.1543 0.0453 0.1766 0.0513 0.4516 #> [11] 0.1454 0.1705 0.1037 0.1265 0.3325 0.3318 0.1732 0.2635 0.2984 0.0788 #> [21] 0.1402 0.1938 0.0446 0.2064 0.1571 0.1533 0.3673 0.1119 0.3043 0.0866 #> [31] 0.0892 0.0732 #>  #> $Q #>  [1] 0.1529 0.0378 0.1207 0.0204 0.3439 0.0218 0.1288 0.1930 0.1817 0.0324 #> [11] 0.0725 0.1574 0.0949 0.2997 0.0105 0.0823 0.1925 0.0497 0.1340 0.1093 #> [21] 0.2495 0.0479 0.1572 0.0815 0.3820 0.0641 0.2128 0.0706 0.2295 0.1201 #> [31] 0.2524 0.1735 #>  #> $CookD #>  [1] 0.11067 0.03576 0.07411 0.00645 0.84672 0.01458 0.02530 0.14768 0.04040 #> [10] 0.06339 0.04568 0.11629 0.04267 0.16427 0.01519 0.11832 0.14448 0.05671 #> [19] 0.17321 0.03733 0.15164 0.04025 0.03036 0.07294 0.26008 0.04261 0.33866 #> [28] 0.03422 0.30260 0.04505 0.09758 0.05503 #>  #> $L #>  [1] 0.2005 0.2795 0.1651 0.0789 1.3160 0.1825 0.0475 0.2145 0.0541 0.8235 #> [11] 0.1702 0.2056 0.1158 0.1448 0.4981 0.4966 0.2095 0.3578 0.4252 0.0855 #> [21] 0.1631 0.2404 0.0466 0.2601 0.1864 0.1811 0.5804 0.1260 0.4373 0.0948 #> [31] 0.0980 0.0790 #>  #> $R #>  [1] 0.1836 0.0483 0.1406 0.0220 0.7964 0.0258 0.1349 0.2344 0.1915 0.0591 #> [11] 0.0848 0.1898 0.1059 0.3431 0.0158 0.1232 0.2328 0.0674 0.1909 0.1187 #> [21] 0.2902 0.0594 0.1646 0.1028 0.4532 0.0757 0.3363 0.0795 0.3299 0.1315 #> [31] 0.2771 0.1872 #>   # try an m=2 case ## res2 <- influence.mlm(Rohwer.mod, m=2, do.coef=FALSE) ## res2.df <- as.data.frame(res2) ## head(res2.df) ## scatterplotMatrix(log(res2.df))   influencePlot(Rohwer.mod, id.n=4, type=\"cookd\")  #>        H      Q  CookD     L      R #> 5  0.568 0.3439 0.8467 1.316 0.7964 #> 10 0.452 0.0324 0.0634 0.824 0.0591 #> 14 0.126 0.2997 0.1643 0.145 0.3431 #> 15 0.332 0.0105 0.0152 0.498 0.0158 #> 25 0.157 0.3820 0.2601 0.186 0.4532 #> 27 0.367 0.2128 0.3387 0.580 0.3363 #> 29 0.304 0.2295 0.3026 0.437 0.3299   # Sake data data(Sake, package=\"heplots\") Sake.mod <- lm(cbind(taste,smell) ~ ., data=Sake) influence(Sake.mod) #> Multivariate influence statistics for model: #>  lm(formula = cbind(taste, smell) ~ ., data = Sake)  #>  m= 1 case deletion diagnostics  #>         H      Q   CookD      L      R #> 1  0.8116 0.5757 1.09033 4.3086 3.0564 #> 2  0.2975 0.0500 0.03472 0.4234 0.0712 #> 3  0.0897 0.0711 0.01490 0.0986 0.0782 #> 4  0.1581 0.1729 0.06379 0.1878 0.2054 #> 5  0.1954 0.4069 0.18550 0.2428 0.5057 #> 6  0.2772 0.0255 0.01652 0.3835 0.0353 #> 7  0.2294 0.2042 0.10928 0.2977 0.2649 #> 8  0.3536 0.0546 0.04506 0.5471 0.0845 #> 9  0.2128 0.2124 0.10548 0.2704 0.2698 #> 10 0.2559 0.0923 0.05510 0.3439 0.1240 #> 11 0.2768 0.2131 0.13763 0.3827 0.2947 #> 12 0.1756 0.0848 0.03474 0.2129 0.1029 #> 13 0.0926 0.1556 0.03364 0.1021 0.1715 #> 14 0.2033 0.0485 0.02301 0.2551 0.0609 #> 15 0.4379 0.0168 0.01717 0.7789 0.0299 #> 16 0.0932 0.0917 0.01995 0.1028 0.1012 #> 17 0.2638 0.0668 0.04109 0.3583 0.0907 #> 18 0.1969 0.0213 0.00978 0.2451 0.0265 #> 19 0.3102 0.0150 0.01088 0.4497 0.0218 #> 20 0.1747 0.1386 0.05651 0.2117 0.1679 #> 21 0.6017 0.2129 0.29893 1.5107 0.5346 #> 22 0.4220 0.1444 0.14223 0.7302 0.2499 #> 23 0.4737 0.1119 0.12364 0.9001 0.2125 #> 24 0.3005 0.1197 0.08395 0.4297 0.1712 #> 25 0.3250 0.4486 0.34018 0.4815 0.6646 #> 26 0.2875 0.1307 0.08767 0.4035 0.1834 #> 27 0.1421 0.0157 0.00519 0.1657 0.0182 #> 28 0.7408 0.0167 0.02889 2.8583 0.0645 #> 29 0.3058 0.1606 0.11458 0.4406 0.2313 #> 30 0.2946 0.1552 0.10670 0.4177 0.2200 influencePlot(Sake.mod, id.n=3, type=\"cookd\")  #>        H      Q  CookD     L      R #> 1  0.812 0.5757 1.0903 4.309 3.0564 #> 21 0.602 0.2129 0.2989 1.511 0.5346 #> 25 0.325 0.4486 0.3402 0.481 0.6646 #> 28 0.741 0.0167 0.0289 2.858 0.0645"},{"path":"http://friendly.github.io/mvinfluence/reference/influencePlot.mlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Influence Plots for Multivariate Linear Models — influencePlot.mlm","title":"Influence Plots for Multivariate Linear Models — influencePlot.mlm","text":"function creates various types “bubble” plots influence measures areas circles representing observations proportional generalized Cook's distances.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/influencePlot.mlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Influence Plots for Multivariate Linear Models — influencePlot.mlm","text":"","code":"# S3 method for mlm influencePlot(   model,   scale = 12,   type = c(\"stres\", \"LR\", \"cookd\"),   infl = mlm.influence(model, do.coef = FALSE),   FUN = det,   fill = TRUE,   fill.col = \"red\",   fill.alpha.max = 0.5,   labels,   id.method = \"noteworthy\",   id.n = if (id.method[1] == \"identify\") Inf else 0,   id.cex = 1,   id.col = palette()[1],   ref.col = \"gray\",   ref.lty = 2,   ref.lab = TRUE,   ... )"},{"path":"http://friendly.github.io/mvinfluence/reference/influencePlot.mlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Influence Plots for Multivariate Linear Models — influencePlot.mlm","text":"model mlm object, returned lm multivariate response. scale factor adjust radii circles, relation sqrt(CookD) type Type plot: one c(\"stres\", \"cookd\", \"LR\"). See Details. infl influence measure structure returned mlm.influence FUN m>1, function applied \\(H\\) \\(Q\\) matrices returning scalar value.  FUN=det FUN=tr possible choices, returning \\(|H|\\) \\(tr(H)\\) respectively. fill, fill.col, fill.alpha.max fill: logical, specifying whether circles filled. fill=TRUE, fill.col gives base fill color transparency specified fill.alpha.max applied. labels, id.method, id.n, id.cex, id.col settings labeling points; see showLabels details. omit point labeling, set id.n=0, default.  default id.method=\"noteworthy\" used function indicate setting labels points large Studentized residuals, hat-values Cook's distances. See Details . Set id.method=\"identify\" interactive point identification. ref.col, ref.lty, ref.lab arguments reference lines.  Incompletely implemented version ... arguments passed ","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/influencePlot.mlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Influence Plots for Multivariate Linear Models — influencePlot.mlm","text":"points identified, returns data frame hat values,               Studentized residuals Cook's distance identified points.                points identified, nothing returned.  function primarily used               side-effect drawing plot.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/influencePlot.mlm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Influence Plots for Multivariate Linear Models — influencePlot.mlm","text":"type=\"stres\" plots squared (internally) Studentized residuals hat values;  type=\"cookd\" plots Cook's distance hat values; type=\"LR\" plots residual components leverage components, attractive property contours constant Cook's distance fall diagonal lines slope = -1. Adjacent reference lines represent multiples influence. id.method=\"noteworthy\" setting also requires setting id.n>0 effect. Using id.method=\"noteworthy\", id.n>0, number points labeled union largest id.n values L, R, CookD.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/influencePlot.mlm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Influence Plots for Multivariate Linear Models — influencePlot.mlm","text":"Barrett, B. E. Ling, R. F. (1992). General Classes Influence Measures Multivariate Regression. Journal American Statistical Association, 87(417), 184-191. Barrett, B. E. (2003). Understanding Influence Multivariate Regression Communications Statistics - Theory Methods, 32, 667-680. McCulloch, C. E. & Meeter, D. (1983). Discussion \"Outliers...\" R. J. Beckman R. D. Cook.  Technometrics, 25, 152-155","code":""},{"path":[]},{"path":"http://friendly.github.io/mvinfluence/reference/influencePlot.mlm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Influence Plots for Multivariate Linear Models — influencePlot.mlm","text":"Michael Friendly","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/influencePlot.mlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Influence Plots for Multivariate Linear Models — influencePlot.mlm","text":"","code":"data(Rohwer, package=\"heplots\") Rohwer2 <- subset(Rohwer, subset=group==2) Rohwer.mod <- lm(cbind(SAT, PPVT, Raven) ~ n+s+ns+na+ss, data=Rohwer2)  influencePlot(Rohwer.mod, id.n=4, type=\"stres\")  #>        H      Q  CookD     L      R #> 42 0.568 0.3439 0.8467 1.316 0.7964 #> 47 0.452 0.0324 0.0634 0.824 0.0591 #> 51 0.126 0.2997 0.1643 0.145 0.3431 #> 52 0.332 0.0105 0.0152 0.498 0.0158 #> 62 0.157 0.3820 0.2601 0.186 0.4532 #> 64 0.367 0.2128 0.3387 0.580 0.3363 #> 66 0.304 0.2295 0.3026 0.437 0.3299 influencePlot(Rohwer.mod, id.n=4, type=\"LR\")  #>        H      Q  CookD     L      R #> 42 0.568 0.3439 0.8467 1.316 0.7964 #> 47 0.452 0.0324 0.0634 0.824 0.0591 #> 51 0.126 0.2997 0.1643 0.145 0.3431 #> 52 0.332 0.0105 0.0152 0.498 0.0158 #> 62 0.157 0.3820 0.2601 0.186 0.4532 #> 64 0.367 0.2128 0.3387 0.580 0.3363 #> 66 0.304 0.2295 0.3026 0.437 0.3299 influencePlot(Rohwer.mod, id.n=4, type=\"cookd\")  #>        H      Q  CookD     L      R #> 42 0.568 0.3439 0.8467 1.316 0.7964 #> 47 0.452 0.0324 0.0634 0.824 0.0591 #> 51 0.126 0.2997 0.1643 0.145 0.3431 #> 52 0.332 0.0105 0.0152 0.498 0.0158 #> 62 0.157 0.3820 0.2601 0.186 0.4532 #> 64 0.367 0.2128 0.3387 0.580 0.3363 #> 66 0.304 0.2295 0.3026 0.437 0.3299  # Sake data data(Sake, package=\"heplots\")   Sake.mod <- lm(cbind(taste,smell) ~ ., data=Sake)   influencePlot(Sake.mod, id.n=3, type=\"stres\")  #>        H      Q  CookD     L      R #> 1  0.812 0.5757 1.0903 4.309 3.0564 #> 21 0.602 0.2129 0.2989 1.511 0.5346 #> 25 0.325 0.4486 0.3402 0.481 0.6646 #> 28 0.741 0.0167 0.0289 2.858 0.0645   influencePlot(Sake.mod, id.n=3, type=\"LR\")  #>        H      Q  CookD     L      R #> 1  0.812 0.5757 1.0903 4.309 3.0564 #> 21 0.602 0.2129 0.2989 1.511 0.5346 #> 25 0.325 0.4486 0.3402 0.481 0.6646 #> 28 0.741 0.0167 0.0289 2.858 0.0645   influencePlot(Sake.mod, id.n=3, type=\"cookd\")  #>        H      Q  CookD     L      R #> 1  0.812 0.5757 1.0903 4.309 3.0564 #> 21 0.602 0.2129 0.2989 1.511 0.5346 #> 25 0.325 0.4486 0.3402 0.481 0.6646 #> 28 0.741 0.0167 0.0289 2.858 0.0645  # Adopted data   data(Adopted, package=\"heplots\") Adopted.mod <- lm(cbind(Age2IQ, Age4IQ, Age8IQ, Age13IQ) ~ AMED + BMIQ, data=Adopted) influencePlot(Adopted.mod, id.n=3)  #>         H      Q CookD      L     R #> 12 0.1315 0.1057 0.273 0.1514 0.122 #> 37 0.0599 0.1469 0.173 0.0638 0.156 #> 44 0.1414 0.0978 0.272 0.1648 0.114 #> 45 0.1986 0.1313 0.513 0.2479 0.164 #> 51 0.0857 0.1669 0.281 0.0938 0.182 influencePlot(Adopted.mod, id.n=3, type=\"LR\", ylim=c(-4,-1.5))  #>         H      Q CookD      L     R #> 12 0.1315 0.1057 0.273 0.1514 0.122 #> 37 0.0599 0.1469 0.173 0.0638 0.156 #> 44 0.1414 0.0978 0.272 0.1648 0.114 #> 45 0.1986 0.1313 0.513 0.2479 0.164 #> 51 0.0857 0.1669 0.281 0.0938 0.182"},{"path":"http://friendly.github.io/mvinfluence/reference/Jtr.html","id":null,"dir":"Reference","previous_headings":"","what":"General Classes of Influence Measures — Jtr","title":"General Classes of Influence Measures — Jtr","text":"functions implement general classes influence measures multivariate regression models defined Barrett Ling (1992), Eqn 2.3, 2.4, shown Table 1.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/Jtr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"General Classes of Influence Measures — Jtr","text":"","code":"Jtr(H, Q, a, b, f)  Jdet(H, Q, a, b, f)  COOKD(H, Q, n, p, r, m)  DFFITS(H, Q, n, p, r, m)  COVRATIO(H, Q, n, p, r, m)"},{"path":"http://friendly.github.io/mvinfluence/reference/Jtr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"General Classes of Influence Measures — Jtr","text":"H scalar \\(m \\times m\\) matrix giving hat values subset \\(\\) Q scalar \\(m \\times m\\) matrix giving residual values subset \\(\\) \\(\\) parameter \\(J^{det}\\) \\(J^{tr}\\) classes b \\(b\\) parameter \\(J^{det}\\) \\(J^{tr}\\) classes f scaling factor \\(J^{det}\\) \\(J^{tr}\\) classes n sample size p number predictor variables r number response variables m deletion subset size","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/Jtr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"General Classes of Influence Measures — Jtr","text":"scalar result computation.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/Jtr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"General Classes of Influence Measures — Jtr","text":"two classes functions, denoted \\(J_I^{det}\\) \\(J_I^{tr}\\), parameters \\(n, p, q\\) data, \\(m\\) subset size \\(\\) \\(b\\) define powers terms formulas, typically set -2, -1, 0. defined terms submatrices deleted index subset \\(\\), $$H_I = X_I (X^T X)^{-1} X_I$$  $$Q_I = E_I (E^T E)^{-1} E_I$$ corresponding hat residual matrices univariate models. subset size \\(m = 1\\) evaluate scalar equivalents hat values studentized residuals. subset size \\(m > 1\\) \\(m \\times m\\) matrices functions \\(J^{det}\\) class use \\(|H_I|\\) \\(|Q_I|\\), \\(J^{tr}\\) class use \\(tr(H_I)\\) \\(tr(Q_I)\\). functions COOKD, COVRATIO, DFFITS implement standard influence measures terms general cases multivariate linear models deletion subsets size m>1, yet incorporated main functions mlm.influence influence.mlm.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/Jtr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"General Classes of Influence Measures — Jtr","text":"Barrett, B. E. Ling, R. F. (1992). General Classes Influence Measures Multivariate Regression. Journal American Statistical Association, 87(417), 184-191.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/Jtr.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"General Classes of Influence Measures — Jtr","text":"Michael Friendly","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/lrPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Regression LR Influence Plot — lrPlot","title":"Regression LR Influence Plot — lrPlot","text":"function creates “bubble” plot functions, R = log(Studentized residuals^2) L = log(H/p*(1-H)) hat values, areas circles representing observations proportional Cook's distances.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/lrPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regression LR Influence Plot — lrPlot","text":"","code":"lrPlot(model, ...)  # S3 method for lm lrPlot(   model,   scale = 12,   xlab = \"log Leverage factor [log H/p*(1-H)]\",   ylab = \"log (Studentized Residual^2)\",   xlim = NULL,   ylim,   labels,   id.method = \"noteworthy\",   id.n = if (id.method[1] == \"identify\") Inf else 0,   id.cex = 1,   id.col = palette()[1],   ref = c(\"h\", \"v\", \"d\", \"c\"),   ref.col = \"gray\",   ref.lty = 2,   ref.lab = TRUE,   ... )"},{"path":"http://friendly.github.io/mvinfluence/reference/lrPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regression LR Influence Plot — lrPlot","text":"model model object fit lm ... arguments pass plot points functions. scale factor adjust radii circles, relation sqrt(CookD) xlab, ylab axis labels. xlim, ylim Limits x y axes. space (L, R) small residuals typically extend y axis enough swamp large residuals, default ylim set range 6 log units starting maximum value. labels, id.method, id.n, id.cex, id.col settings labeling points; see link{showLabels} details. omit point labeling, set id.n=0, default.  default id.method=\"noteworthy\" used function indicate setting labels points large Studentized residuals, hat-values Cook's distances. See Details . Set id.method=\"identify\" interactive point identification. ref Options draw reference lines, one c(\"h\", \"v\", \"d\", \"c\"). \"h\" \"v\" draw horizontal vertical  reference lines noteworthy values R L respectively. \"d\"  draws equally spaced diagonal reference lines contours equal CookD.  \"c\" draws diagonal reference lines corresponding approximate 0.95 0.99 contours CookD. ref.col, ref.lty Color line type reference lines.  Reference lines \"c\" %% ref handled separately. ref.lab logical, indicating whether reference lines labeled.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/lrPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regression LR Influence Plot — lrPlot","text":"points identified, returns data frame hat values,         Studentized residuals Cook's distance identified points.          points identified, nothing returned.  function primarily used         side-effect drawing plot.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/lrPlot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Regression LR Influence Plot — lrPlot","text":"plot, suggested McCulloch & Meeter (1983) attractive property contours equal Cook's distance diagonal lines slope = -1.  Various reference lines drawn plot corresponding twice three times average hat value, “large” squared studentized residual contours Cook's distance. id.method=\"noteworthy\" setting also requires setting id.n>0 effect. Using id.method=\"noteworthy\", id.n>0, number points labeled union largest id.n values L, R, CookD.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/lrPlot.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Regression LR Influence Plot — lrPlot","text":". J. Lawrence (1995). Deletion Influence Masking Regression Journal Royal Statistical Society. Series B (Methodological) , Vol. 57, . 1, pp. 181-189. McCulloch, C. E. & Meeter, D. (1983). Discussion \"Outliers...\" R. J. Beckman R. D. Cook.  Technometrics, 25, 152-155.","code":""},{"path":[]},{"path":"http://friendly.github.io/mvinfluence/reference/lrPlot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Regression LR Influence Plot — lrPlot","text":"Michael Friendly","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/lrPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Regression LR Influence Plot — lrPlot","text":"","code":"# artificial example from Lawrence (1995) x <- c( 0, 0, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 18, 18 ) y <- c( 0, 6, 6, 7, 6, 7, 6, 7, 6,  7,  6,  7,  7,  18 ) DF <- data.frame(x,y, row.names=LETTERS[1:length(x)]) DF #>    x  y #> A  0  0 #> B  0  6 #> C  7  6 #> D  7  7 #> E  8  6 #> F  8  7 #> G  9  6 #> H  9  7 #> I 10  6 #> J 10  7 #> K 11  6 #> L 11  7 #> M 18  7 #> N 18 18  with(DF, {   plot(x,y, pch=16, cex=1.3)   abline(lm(y~x), col=\"red\", lwd=2)   NB <- c(1,2,13,14)   text(x[NB],y[NB], LETTERS[NB], pos=c(4,4,2,2))   } )   mod <- lm(y~x, data=DF) # standard influence plot from car influencePlot(mod, id.n=4) #> Warning: \"id.n\" is not a graphical parameter #> Warning: \"id.n\" is not a graphical parameter #> Warning: \"id.n\" is not a graphical parameter #> Warning: \"id.n\" is not a graphical parameter #> Warning: \"id.n\" is not a graphical parameter #> Warning: \"id.n\" is not a graphical parameter #> Warning: \"id.n\" is not a graphical parameter  #>   StudRes   Hat CookD #> M   -2.16 0.307 0.793 #> N    5.16 0.307 1.879  # lrPlot version lrPlot(mod, id.n=4)  #> Note: 7 points less than R= -2 have been clipped to preserve resolution #>   Rstudent   Hat CookD     L      R #> A    -1.05 0.307 0.240 -1.51 0.0884 #> B     1.70 0.307 0.553 -1.51 1.0612 #> M    -2.16 0.307 0.793 -1.51 1.5427 #> N     5.16 0.307 1.879 -1.51 3.2807   library(car) dmod <- lm(prestige ~ income + education, data = Duncan) influencePlot(dmod, id.n=3) #> Warning: \"id.n\" is not a graphical parameter #> Warning: \"id.n\" is not a graphical parameter #> Warning: \"id.n\" is not a graphical parameter #> Warning: \"id.n\" is not a graphical parameter #> Warning: \"id.n\" is not a graphical parameter #> Warning: \"id.n\" is not a graphical parameter #> Warning: \"id.n\" is not a graphical parameter  #>             StudRes    Hat CookD #> minister      3.135 0.1731 0.566 #> reporter     -2.397 0.0544 0.099 #> conductor    -1.704 0.1945 0.224 #> RR.engineer   0.809 0.2691 0.081 lrPlot(dmod, id.n=3)  #> Note: 11 points less than R= -3 have been clipped to preserve resolution #>             Rstudent    Hat  CookD     L      R #> minister       3.135 0.1731 0.5664 -2.66  2.285 #> reporter      -2.397 0.0544 0.0990 -3.95  1.748 #> conductor     -1.704 0.1945 0.2236 -2.52  1.066 #> contractor     2.044 0.0433 0.0585 -4.20  1.430 #> RR.engineer    0.809 0.2691 0.0810 -2.10 -0.424"},{"path":"http://friendly.github.io/mvinfluence/reference/mlm.influence.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Regression Deletion Diagnostics for Multivariate Linear Models — mlm.influence","title":"Calculate Regression Deletion Diagnostics for Multivariate Linear Models — mlm.influence","text":"mlm.influence main computational function package. usually called directly, rather via alias, influence.mlm, S3 method mlm object.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mlm.influence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Regression Deletion Diagnostics for Multivariate Linear Models — mlm.influence","text":"","code":"mlm.influence(model, do.coef = TRUE, m = 1, ...)"},{"path":"http://friendly.github.io/mvinfluence/reference/mlm.influence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Regression Deletion Diagnostics for Multivariate Linear Models — mlm.influence","text":"model mlm object, returned lm multivariate response. .coef logical. coefficients returned inflmlm object? m Size subsets deletion diagnostics ... arguments passed methods","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mlm.influence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Regression Deletion Diagnostics for Multivariate Linear Models — mlm.influence","text":"mlm.influence returns S3 object class inflmlm, list following components: m Deletion subset size H Hat values, \\(H_I\\). m=1, vector             diagonal entries ‘hat’ matrix.  Otherwise, list \\(m\\times m\\)              matrices corresponding subsets. Q Residuals, \\(Q_I\\). CookD Cook's distance values L Leverage components R Residual components subsets Indices subsets CookD Cook's distance values L Leverage components R Residual components subsets Indices observations subsets size m labels Observation labels call Model call mlm object Beta Deletion regression coefficients-- included ifdo.coef=TRUE","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mlm.influence.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Regression Deletion Diagnostics for Multivariate Linear Models — mlm.influence","text":"computations methods m=1 case straight-forward, computations m>1 case.  Associated methods m>1 still development.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mlm.influence.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate Regression Deletion Diagnostics for Multivariate Linear Models — mlm.influence","text":"Barrett, B. E. Ling, R. F. (1992). General Classes Influence Measures Multivariate Regression. Journal American Statistical Association, 87(417), 184-191. Barrett, B. E. (2003). Understanding Influence Multivariate Regression. Communications Statistics -- Theory Methods, 32, 3, 667-680.","code":""},{"path":[]},{"path":"http://friendly.github.io/mvinfluence/reference/mlm.influence.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate Regression Deletion Diagnostics for Multivariate Linear Models — mlm.influence","text":"Michael Friendly","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mlm.influence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Regression Deletion Diagnostics for Multivariate Linear Models — mlm.influence","text":"","code":"Rohwer2 <- subset(Rohwer, subset=group==2) rownames(Rohwer2)<- 1:nrow(Rohwer2) Rohwer.mod <- lm(cbind(SAT, PPVT, Raven) ~ n+s+ns+na+ss, data=Rohwer2) Rohwer.mod #>  #> Call: #> lm(formula = cbind(SAT, PPVT, Raven) ~ n + s + ns + na + ss,  #>     data = Rohwer2) #>  #> Coefficients: #>              SAT       PPVT      Raven    #> (Intercept)  -28.4675   39.6971   13.2438 #> n              3.2571    0.0673    0.0593 #> s              2.9966    0.3700    0.4924 #> ns            -5.8591   -0.3744   -0.1640 #> na             5.6662    1.5230    0.1190 #> ss            -0.6227    0.4102   -0.1212 #>  influence(Rohwer.mod) #> Multivariate influence statistics for model: #>  lm(formula = cbind(SAT, PPVT, Raven) ~ n + s + ns + na + ss,  #>     data = Rohwer2)  #>  m= 1 case deletion diagnostics  #>         H      Q   CookD      L      R #> 1  0.1670 0.1529 0.11067 0.2005 0.1836 #> 2  0.2185 0.0378 0.03576 0.2795 0.0483 #> 3  0.1417 0.1207 0.07411 0.1651 0.1406 #> 4  0.0731 0.0204 0.00645 0.0789 0.0220 #> 5  0.5682 0.3439 0.84672 1.3160 0.7964 #> 6  0.1543 0.0218 0.01458 0.1825 0.0258 #> 7  0.0453 0.1288 0.02530 0.0475 0.1349 #> 8  0.1766 0.1930 0.14768 0.2145 0.2344 #> 9  0.0513 0.1817 0.04040 0.0541 0.1915 #> 10 0.4516 0.0324 0.06339 0.8235 0.0591 #> 11 0.1454 0.0725 0.04568 0.1702 0.0848 #> 12 0.1705 0.1574 0.11629 0.2056 0.1898 #> 13 0.1037 0.0949 0.04267 0.1158 0.1059 #> 14 0.1265 0.2997 0.16427 0.1448 0.3431 #> 15 0.3325 0.0105 0.01519 0.4981 0.0158 #> 16 0.3318 0.0823 0.11832 0.4966 0.1232 #> 17 0.1732 0.1925 0.14448 0.2095 0.2328 #> 18 0.2635 0.0497 0.05671 0.3578 0.0674 #> 19 0.2984 0.1340 0.17321 0.4252 0.1909 #> 20 0.0788 0.1093 0.03733 0.0855 0.1187 #> 21 0.1402 0.2495 0.15164 0.1631 0.2902 #> 22 0.1938 0.0479 0.04025 0.2404 0.0594 #> 23 0.0446 0.1572 0.03036 0.0466 0.1646 #> 24 0.2064 0.0815 0.07294 0.2601 0.1028 #> 25 0.1571 0.3820 0.26008 0.1864 0.4532 #> 26 0.1533 0.0641 0.04261 0.1811 0.0757 #> 27 0.3673 0.2128 0.33866 0.5804 0.3363 #> 28 0.1119 0.0706 0.03422 0.1260 0.0795 #> 29 0.3043 0.2295 0.30260 0.4373 0.3299 #> 30 0.0866 0.1201 0.04505 0.0948 0.1315 #> 31 0.0892 0.2524 0.09758 0.0980 0.2771 #> 32 0.0732 0.1735 0.05503 0.0790 0.1872  # extract the most influential cases influence(Rohwer.mod) |>      as.data.frame() |>      dplyr::arrange(dplyr::desc(CookD)) |>      head() #>        H     Q CookD     L     R #> 5  0.568 0.344 0.847 1.316 0.796 #> 27 0.367 0.213 0.339 0.580 0.336 #> 29 0.304 0.229 0.303 0.437 0.330 #> 25 0.157 0.382 0.260 0.186 0.453 #> 19 0.298 0.134 0.173 0.425 0.191 #> 14 0.126 0.300 0.164 0.145 0.343  # Sake data Sake.mod <- lm(cbind(taste,smell) ~ ., data=Sake) influence(Sake.mod) |>     as.data.frame() |>      dplyr::arrange(dplyr::desc(CookD)) |> head() #>        H     Q CookD     L     R #> 1  0.812 0.576 1.090 4.309 3.056 #> 25 0.325 0.449 0.340 0.481 0.665 #> 21 0.602 0.213 0.299 1.511 0.535 #> 5  0.195 0.407 0.186 0.243 0.506 #> 22 0.422 0.144 0.142 0.730 0.250 #> 11 0.277 0.213 0.138 0.383 0.295"},{"path":"http://friendly.github.io/mvinfluence/reference/mpower.html","id":null,"dir":"Reference","previous_headings":"","what":"General Matrix Power — mpower","title":"General Matrix Power — mpower","text":"Calculates n-th power square matrix, n can positive negative integer fractional power.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mpower.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"General Matrix Power — mpower","text":"","code":"mpower(A, n)  A %^% n"},{"path":"http://friendly.github.io/mvinfluence/reference/mpower.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"General Matrix Power — mpower","text":"square matrix. Must also symmetric non-integer powers. n matrix power","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mpower.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"General Matrix Power — mpower","text":"Returns matrix \\(^n\\)","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mpower.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"General Matrix Power — mpower","text":"n<0, method applied \\(^{-1}\\).  n integer, function uses Russian peasant method, repeated squaring efficiency.   Otherwise, uses spectral decomposition , \\(\\mathbf{}^n = \\mathbf{V} \\mathbf{D}^n \\mathbf{V}^{T}\\) requiring symmetric matrix.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mpower.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"General Matrix Power — mpower","text":"https://en.wikipedia.org/wiki/Exponentiation_by_squaring","code":""},{"path":[]},{"path":"http://friendly.github.io/mvinfluence/reference/mpower.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"General Matrix Power — mpower","text":"Michael Friendly","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mpower.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"General Matrix Power — mpower","text":"","code":"M <- matrix(sample(1:9), 3,3) mpower(M,2) #>      [,1] [,2] [,3] #> [1,]   50   70   78 #> [2,]   31   83   57 #> [3,]   82  113  138 mpower(M,4) #>       [,1]  [,2]  [,3] #> [1,] 11066 18124 18654 #> [2,]  8797 15500 15015 #> [3,] 18919 30713 31881  # make a symmetric matrix MM <- crossprod(M) mpower(MM, -1) #>         [,1]    [,2]    [,3] #> [1,]  0.2209  0.0399 -0.1662 #> [2,]  0.0399  0.0347 -0.0503 #> [3,] -0.1662 -0.0503  0.1480 Mhalf <- mpower(MM, 1/2) all.equal(MM, Mhalf %*% Mhalf) #> [1] TRUE"},{"path":"http://friendly.github.io/mvinfluence/reference/mvinfluence.html","id":null,"dir":"Reference","previous_headings":"","what":"Influence Measures and Diagnostic Plots for Multivariate Linear Models — mvinfluence","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models — mvinfluence","text":"Functions package compute regression deletion diagnostics multivariate linear  models following methods proposed Barrett & Ling (1992) provide associated diagnostic plots.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mvinfluence.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models — mvinfluence","text":"design goal package , extension standard methods univariate linear models, able fit linear model multivariate response, get useful diagnostics plots diagnostic measures include hat-values (leverages), generalized Cook's distance generalized squared 'studentized' residuals.  Several types plots detect  influential observations provided. addition, functions provide diagnostics deletion subsets observations  size m>1. case theoretically interesting sometimes pairs (m=2)  influential observations can mask , sometimes can joint influence  far exceeding individual effects, well interesting phenomena described  Lawrence (1995). Associated methods case m>1 still development package. main function package S3 method, influence.mlm, simple wrapper mlm.influence, actual computations. design dictated used stats package, provides generic method influence methods influence.lm influence.glm. car package extends include influence.lme models fit lme`. following sections describe notation measures used calculations.","code":"mymlm <- lm( cbind(y1, y2, y3) ~ x1 + x2 + x3, data=mydata) influence(mymlm)   hatvalues(mymlm)   influencePlot(mymlm, ...)"},{"path":"http://friendly.github.io/mvinfluence/reference/mvinfluence.html","id":"notation","dir":"Reference","previous_headings":"","what":"Notation","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models — mvinfluence","text":"Let \\(\\mathbf{X}\\) model matrix multivariate linear model,  \\(\\mathbf{Y}_{n \\times p} = \\mathbf{X}_{n \\times r} \\mathbf{\\beta}_{r \\times p} + \\mathbf{E}_{n \\times p}\\). usual least squares estimate \\(\\mathbf{\\beta}\\) given \\(\\mathbf{B} = (\\mathbf{X}^{T} \\mathbf{X})^{-1}  \\mathbf{X}^{T} \\mathbf{Y}\\). let \\(\\mathbf{X}_I\\) submatrix \\(\\mathbf{X}\\) whose \\(m\\) rows indexed \\(\\), \\(\\mathbf{X}_{()}\\) complement, submatrix \\(\\mathbf{X}\\) \\(m\\) rows \\(\\) deleted, Matrices \\(\\mathbf{Y}_I\\), \\(\\mathbf{Y}_{()}\\) defined similarly. calculation regression coefficients,  \\(\\mathbf{B}_{()} = (\\mathbf{X}_{()}^{T} \\mathbf{X}_{()})^{-1} \\mathbf{X}_{()}^{T} \\mathbf{Y}_{}\\) estimated   coefficients  cases indexed \\(\\) removed. corresponding residuals  \\(\\mathbf{E}_{()} = \\mathbf{Y}_{()} - \\mathbf{X}_{()} \\mathbf{B}_{()}\\).","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mvinfluence.html","id":"measures","dir":"Reference","previous_headings":"","what":"Measures","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models — mvinfluence","text":"influence measures defined Barrett & Ling (1992) functions two matrices \\(\\mathbf{H}_I\\) \\(\\mathbf{Q}_I\\)  defined follows: full data set, “hat matrix”, \\(\\mathbf{H}\\), given             \\(\\mathbf{H} = \\mathbf{X} (\\mathbf{X}^{T} \\mathbf{X})^{-1} \\mathbf{X}^{T} \\), \\(\\mathbf{H}_I\\) \\(m \\times m\\) submatrix \\(\\mathbf{H}\\) corresponding index set \\(\\),             \\(\\mathbf{H}_I = \\mathbf{X} (\\mathbf{X}_I^{T} \\mathbf{X}_I)^{-1} \\mathbf{X}^{T} \\), \\(\\mathbf{Q}\\) analog \\(\\mathbf{H}\\) defined residual matrix \\(\\mathbf{E}\\), ,             \\(\\mathbf{Q} = \\mathbf{E} (\\mathbf{E}^{T} \\mathbf{E})^{-1} \\mathbf{E}^{T} \\), corresponding submatrix             \\(\\mathbf{Q}_I = \\mathbf{E} (\\mathbf{E}_I^{T} \\mathbf{E}_I)^{-1} \\mathbf{E}^{T} \\),","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mvinfluence.html","id":"cook-s-distance","dir":"Reference","previous_headings":"","what":"Cook's distance","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models — mvinfluence","text":"terms, Cook's distance defined univariate response  $$D_I = (\\mathbf{b} - \\mathbf{b}_{()})^T (\\mathbf{X}^T \\mathbf{X}) (\\mathbf{b} - \\mathbf{b}_{()}) / p s^2 \\; ,$$   measure squared distance coefficients \\(\\mathbf{b}\\) full data set  \\(\\mathbf{b}_{()}\\)   obtained cases \\(\\) deleted. multivariate case, Cook's distance obtained  replacing vector coefficients \\(\\mathbf{b}\\) \\(\\mathrm{vec} (\\mathbf{B})\\), result stringing  coefficients responses single \\(n \\times p\\)-length vector.  $$D_I = \\frac{1}{p} [\\mathrm{vec} (\\mathbf{B} - \\mathbf{B}_{()})]^T (S_{-1} \\otimes \\mathbf{X}^T \\mathbf{X}) \\mathrm{vec} (\\mathbf{B} - \\mathbf{B}_{()})  \\; ,$$   \\(\\otimes\\) Kronecker (direct) product  \\(\\mathbf{S} = \\mathbf{E}^T \\mathbf{E} / (n-p)\\) covariance matrix residuals.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/mvinfluence.html","id":"leverage-and-residual-components","dir":"Reference","previous_headings":"","what":"Leverage and residual components","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models — mvinfluence","text":"univariate response, m = 1, Cook's distance can re-written product leverage residual components  $$D_i = \\left(\\frac{n-p}{p} \\right) \\frac{h_{ii}}{(1 - h_{ii})^2 q_{ii} } \\;.$$ can define leverage component \\(L_i\\) residual component \\(R_i\\) $$L_i = \\frac{h_{ii}}{1 - h_{ii}} \\quad\\quad R_i = \\frac{q_{ii}}{1 - h_{ii}} \\;.$$   \\(R_i\\) studentized residual, \\(D_i \\propto L_i \\times R_i\\). general, multivariate case analogous matrix expressions \\(\\mathbf{L}\\) \\(\\mathbf{R}\\).  m > 1, quantities \\(\\mathbf{H}_I\\), \\(\\mathbf{Q}_I\\), \\(\\mathbf{L}_I\\),  \\(\\mathbf{R}_I\\) \\(m \\times m\\) matrices.  scalar quantities needed, package functions apply  function, FUN, either det() tr() calculate measure “size”, ","code":"H <- sapply(x$H, FUN)   Q <- sapply(x$Q, FUN)   L <- sapply(x$L, FUN)   R <- sapply(x$R, FUN)"},{"path":"http://friendly.github.io/mvinfluence/reference/mvinfluence.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Influence Measures and Diagnostic Plots for Multivariate Linear Models — mvinfluence","text":"Barrett, B. E. Ling, R. F. (1992).      General Classes Influence Measures Multivariate Regression.      Journal American Statistical Association, 87(417), 184-191. Barrett, B. E. (2003). Understanding Influence Multivariate Regression.      Communications Statistics -- Theory Methods, 32, 3, 667-680. . J. Lawrence (1995).      Deletion Influence Masking Regression.      Journal Royal Statistical Society. Series B (Methodological) , 57, 1, 181-189.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/print.inflmlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Print an inflmlm object — print.inflmlm","title":"Print an inflmlm object — print.inflmlm","text":"Print inflmlm object","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/print.inflmlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print an inflmlm object — print.inflmlm","text":"","code":"# S3 method for inflmlm print(x, digits = max(3, getOption(\"digits\") - 4), FUN = det, ...)"},{"path":"http://friendly.github.io/mvinfluence/reference/print.inflmlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print an inflmlm object — print.inflmlm","text":"x inflmlm object digits Number digits print FUN Function combine diagnostics m>1, one det tr ... passed print()","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/print.inflmlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print an inflmlm object — print.inflmlm","text":"Invisibly returns object","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/print.inflmlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print an inflmlm object — print.inflmlm","text":"","code":"# none"},{"path":"http://friendly.github.io/mvinfluence/reference/tr.html","id":null,"dir":"Reference","previous_headings":"","what":"Matrix trace — tr","title":"Matrix trace — tr","text":"Calculates trace matrix","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/tr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Matrix trace — tr","text":"","code":"tr(M)"},{"path":"http://friendly.github.io/mvinfluence/reference/tr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Matrix trace — tr","text":"M matrix","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/tr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Matrix trace — tr","text":"returns sum diagonal elements matrix","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/tr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Matrix trace — tr","text":"square, symmetric matrices, covariance matrices, trace sometimes used measure size, e.g., Pillai's trace criterion MLM.","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/tr.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Matrix trace — tr","text":"Michael Friendly","code":""},{"path":"http://friendly.github.io/mvinfluence/reference/tr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Matrix trace — tr","text":"","code":"M <- matrix(sample(1:9), 3,3) tr(M) #> [1] 12"}]
