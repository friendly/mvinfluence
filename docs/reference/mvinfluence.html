<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Influence Measures and Diagnostic Plots for Multivariate Linear Models — mvinfluence • mvinfluence</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Influence Measures and Diagnostic Plots for Multivariate Linear Models — mvinfluence"><meta name="description" content="Functions in this package compute regression deletion diagnostics for multivariate linear
models following methods proposed by Barrett &amp;amp; Ling (1992) and provide some associated diagnostic plots."><meta property="og:description" content="Functions in this package compute regression deletion diagnostics for multivariate linear
models following methods proposed by Barrett &amp;amp; Ling (1992) and provide some associated diagnostic plots."><meta property="og:image" content="http://friendly.github.io/mvinfluence/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mvinfluence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/uni-vs-multi.html">Univariate versus Multivariate Influence</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/mvinfluence/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Influence Measures and Diagnostic Plots for Multivariate Linear Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/friendly/mvinfluence/blob/HEAD/R/mvinfluence-package.R" class="external-link"><code>R/mvinfluence-package.R</code></a></small>
      <div class="d-none name"><code>mvinfluence.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions in this package compute regression deletion diagnostics for multivariate linear
models following methods proposed by Barrett &amp; Ling (1992) and provide some associated diagnostic plots.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The design goal for this package is that, as an extension of standard methods for univariate linear models, you should be able to fit a linear model with a multivariate response,</p><div class="sourceCode"><pre><code><span></span>
<span>  <span class="va">mymlm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y1</span>, <span class="va">y2</span>, <span class="va">y3</span><span class="op">)</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span>, data<span class="op">=</span><span class="va">mydata</span><span class="op">)</span></span></code></pre></div><p>and then get useful diagnostics and plots with</p><div class="sourceCode"><pre><code><span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.influence.html" class="external-link">influence</a></span><span class="op">(</span><span class="va">mymlm</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">hatvalues</a></span><span class="op">(</span><span class="va">mymlm</span><span class="op">)</span></span>
<span>  <span class="fu">influencePlot</span><span class="op">(</span><span class="va">mymlm</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>

<p>The diagnostic measures include hat-values (leverages), generalized Cook's distance and
generalized squared 'studentized' residuals.  Several types of plots to detect
influential observations are provided.</p>
<p>In addition, the functions provide diagnostics for deletion of subsets of observations
of size <code>m&gt;1</code>. This case is theoretically interesting because sometimes pairs (<code>m=2</code>)
of influential observations can mask each other, sometimes they can have joint influence
far exceeding their individual effects, as well as other interesting phenomena described
by Lawrence (1995). Associated methods for the case <code>m&gt;1</code> are still under development in this package.</p>
<p>The main function in the package is the S3 method, <code><a href="influence.mlm.html">influence.mlm</a></code>, a simple wrapper for
<code><a href="mlm.influence.html">mlm.influence</a></code>, which does the actual computations.
This design was dictated by that used in the <span class="pkg">stats</span> package, which provides
the generic method <code><a href="https://rdrr.io/r/stats/lm.influence.html" class="external-link">influence</a></code> and methods
<code><a href="https://rdrr.io/r/stats/lm.influence.html" class="external-link">influence.lm</a></code> and <code><a href="https://rdrr.io/r/stats/lm.influence.html" class="external-link">influence.glm</a></code>. The <span class="pkg">car</span> package extends this to include
<code><a href="https://rdrr.io/pkg/car/man/influence-mixed-models.html" class="external-link">influence.lme</a></code> for models fit by <code><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></code>.</p>
<p>The following sections describe the notation and measures used in the calculations.</p>
    </div>
    <div class="section level2">
    <h2 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a></h2>



<p>Let \(\mathbf{X}\) be the model matrix in the multivariate linear model,
\(\mathbf{Y}_{n \times p} = \mathbf{X}_{n \times r} \boldsymbol{\beta}_{r \times p} + \mathbf{E}_{n \times p}\).
The usual least squares estimate of \(\boldsymbol{\beta}\) is given by
\(\mathbf{B} = (\mathbf{X}^{T} \mathbf{X})^{-1}  \mathbf{X}^{T} \mathbf{Y}\).</p>
<p>Then let</p><ul><li><p>\(\mathbf{X}_I\) be the submatrix of \(\mathbf{X}\) whose \(m\) rows are indexed by \(I\),</p></li>
<li><p>\(\mathbf{X}_{(-I)}\) is the complement, the submatrix of \(\mathbf{X}\) with the \(m\) rows in \(I\) deleted,</p></li>
</ul><p>Matrices \(\mathbf{Y}_I\), \(\mathbf{Y}_{(-I)}\) are defined similarly.</p>
<p>In the calculation of regression coefficients,
 \(\mathbf{B}_{(-I)} = (\mathbf{X}_{(-I)}^{T} \mathbf{X}_{(-I)})^{-1} \mathbf{X}_{(-I)}^{T} \mathbf{Y}_{I}\) are the estimated
 coefficients
 when the cases indexed by \(I\) have been removed. The corresponding residuals are
 \(\mathbf{E}_{(-I)} = \mathbf{Y}_{(-I)} - \mathbf{X}_{(-I)} \mathbf{B}_{(-I)}\).</p>
    </div>
    <div class="section level2">
    <h2 id="measures">Measures<a class="anchor" aria-label="anchor" href="#measures"></a></h2>



<p>The influence measures defined by Barrett &amp; Ling (1992) are functions of two matrices \(\mathbf{H}_I\) and \(\mathbf{Q}_I\)
 defined as follows:</p><ul><li><p>For the full data set, the “hat matrix”, \(\mathbf{H}\), is given by
            \(\mathbf{H} = \mathbf{X} (\mathbf{X}^{T} \mathbf{X})^{-1} \mathbf{X}^{T} \),</p></li>
<li><p>\(\mathbf{H}_I\) is \(m \times m\) the submatrix of \(\mathbf{H}\) corresponding to the index set \(I\),
            \(\mathbf{H}_I = \mathbf{X} (\mathbf{X}_I^{T} \mathbf{X}_I)^{-1} \mathbf{X}^{T} \),</p></li>
<li><p>\(\mathbf{Q}\) is the analog of \(\mathbf{H}\) defined for the residual matrix \(\mathbf{E}\), that is,
            \(\mathbf{Q} = \mathbf{E} (\mathbf{E}^{T} \mathbf{E})^{-1} \mathbf{E}^{T} \), with corresponding submatrix
            \(\mathbf{Q}_I = \mathbf{E} (\mathbf{E}_I^{T} \mathbf{E}_I)^{-1} \mathbf{E}^{T} \),</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="cook-s-distance">Cook's distance<a class="anchor" aria-label="anchor" href="#cook-s-distance"></a></h2>



<p>In these terms, Cook's distance is defined for a univariate response by
 $$D_I = (\mathbf{b} - \mathbf{b}_{(-I)})^T (\mathbf{X}^T \mathbf{X}) (\mathbf{b} - \mathbf{b}_{(-I)}) / p s^2 \; ,$$
 a measure of the squared distance between the coefficients \(\mathbf{b}\) for the full data set and those
 \(\mathbf{b}_{(-I)}\)
 obtained when the cases in \(I\) are deleted.</p>
<p>In the multivariate case, Cook's distance is obtained
 by replacing the vector of coefficients \(\mathbf{b}\) by \(\mathrm{vec} (\mathbf{B})\), the result of stringing out
 the coefficients for all responses in a single \(n \times p\)-length vector.
 $$D_I = \frac{1}{p} [\mathrm{vec} (\mathbf{B} - \mathbf{B}_{(-I)})]^T (S_{-1} \otimes \mathbf{X}^T \mathbf{X}) \mathrm{vec} (\mathbf{B} - \mathbf{B}_{(-I)})  \; ,$$
 where \(\otimes\) is the Kronecker (direct) product and
 \(\mathbf{S} = \mathbf{E}^T \mathbf{E} / (n-p)\) is the covariance matrix of the residuals.</p>
    </div>
    <div class="section level2">
    <h2 id="leverage-and-residual-components">Leverage and residual components<a class="anchor" aria-label="anchor" href="#leverage-and-residual-components"></a></h2>



<p>For a univariate response, and when <code>m = 1</code>, Cook's distance can be re-written as a product of leverage and residual components as
 $$D_i = \left(\frac{n-p}{p} \right) \frac{h_{ii}}{(1 - h_{ii})^2 q_{ii} } \;.$$</p>
<p>Then we can define a leverage component \(L_i\) and residual component \(R_i\) as</p>
<p>$$L_i = \frac{h_{ii}}{1 - h_{ii}} \quad\quad R_i = \frac{q_{ii}}{1 - h_{ii}} \;.$$
 \(R_i\) is the studentized residual, and \(D_i \propto L_i \times R_i\).</p>
<p>In the general, multivariate case there are analogous matrix expressions for \(\mathbf{L}\) and \(\mathbf{R}\).
 When <code>m &gt; 1</code>, the quantities \(\mathbf{H}_I\), \(\mathbf{Q}_I\), \(\mathbf{L}_I\), and
 \(\mathbf{R}_I\) are \(m \times m\) matrices.  Where scalar quantities are needed, the package functions apply
 a function, <code>FUN</code>, either <code><a href="https://rdrr.io/r/base/det.html" class="external-link">det()</a></code> or <code><a href="tr.html">tr()</a></code> to calculate a measure of “size”, as in</p><div class="sourceCode"><pre><code><span></span>
<span>  <span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">H</span>, <span class="va">FUN</span><span class="op">)</span></span>
<span>  <span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">Q</span>, <span class="va">FUN</span><span class="op">)</span></span>
<span>  <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">L</span>, <span class="va">FUN</span><span class="op">)</span></span>
<span>  <span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">R</span>, <span class="va">FUN</span><span class="op">)</span></span></code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="other-measures">Other measures<a class="anchor" aria-label="anchor" href="#other-measures"></a></h2>


<p>The <code><a href="https://rdrr.io/r/stats/stats-package.html" class="external-link">stats-package</a></code> provides a collection of other leave-one-out deletion diagnostics that work with
multivariate response models.</p>
<dl><dt><code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">rstandard</a></code></dt>
<dd><p>Standardized residuals, re-scaling the residuals to have unit variance</p></dd>

   <dt><code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">rstudent</a></code></dt>
<dd><p>Studentized residuals, re-scaling the residuals to have leave-one-out variance</p></dd>

   <dt><code>dfits</code></dt>
<dd><p>a scaled measure of the change in the predicted value for the <em>i</em>th observation</p></dd>

   <dt><code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">covratio</a></code></dt>
<dd><p>the change in the determinant of the covariance matrix of the estimates by deleting the <em>i</em>th observation</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Barrett, B. E. and Ling, R. F. (1992).
     General Classes of Influence Measures for Multivariate Regression.
     <em>Journal of the American Statistical Association</em>, <b>87</b>(417), 184-191.</p>
<p>Barrett, B. E. (2003). Understanding Influence in Multivariate Regression.
     <em>Communications in Statistics – Theory and Methods</em>, <b>32</b>, 3, 667-680.</p>
<p>A. J. Lawrence (1995).
     Deletion Influence and Masking in Regression.
     <em>Journal of the Royal Statistical Society. Series B (Methodological)</em> , <b>57</b>, 1, 181-189.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Useful links:</p><ul><li><p><a href="https://github.com/friendly/mvinfluence" class="external-link">https://github.com/friendly/mvinfluence</a></p></li>
<li><p><a href="https://friendly.github.io/mvinfluence/" class="external-link">https://friendly.github.io/mvinfluence/</a></p></li>
<li><p>Report bugs at <a href="https://github.com/friendly/mvinfluence/issues" class="external-link">https://github.com/friendly/mvinfluence/issues</a></p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><strong>Maintainer</strong>: Michael Friendly <a href="mailto:friendly@yorku.ca">friendly@yorku.ca</a> (<a href="https://orcid.org/0000-0002-3237-0941" class="external-link">ORCID</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Rohwer</span>, package<span class="op">=</span><span class="st">"heplots"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Rohwer2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Rohwer</span>, subset<span class="op">=</span><span class="va">group</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Rohwer2</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Rohwer2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Rohwer.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">SAT</span>, <span class="va">PPVT</span>, <span class="va">Raven</span><span class="op">)</span> <span class="op">~</span> <span class="va">n</span><span class="op">+</span><span class="va">s</span><span class="op">+</span><span class="va">ns</span><span class="op">+</span><span class="va">na</span><span class="op">+</span><span class="va">ss</span>, data<span class="op">=</span><span class="va">Rohwer2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">influencePlot</span><span class="op">(</span><span class="va">Rohwer.mod</span>, id.n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mvinfluence-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            H          Q      CookD         L         R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.5682146 0.34387765 0.84671734 1.3159654 0.7964087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.4516115 0.03239271 0.06339198 0.8235248 0.0590689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 0.1264993 0.29967992 0.16427359 0.1448187 0.3430792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 0.1571260 0.38198170 0.26008352 0.1864170 0.4531896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 0.3672647 0.21279661 0.33866160 0.5804397 0.3363122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 0.3042700 0.22949988 0.30259634 0.4373392 0.3298692</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

