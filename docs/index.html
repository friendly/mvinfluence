<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Computes regression deletion diagnostics for multivariate linear models and provides some associated
	diagnostic plots.  The diagnostic measures include hat-values (leverages), generalized Cooks distance, and
	generalized squared studentized' residuals.  Several types of plots to detect influential observations are
	provided.">
<title>Influence Measures and Diagnostic Plots for Multivariate Linear Models • mvinfluence</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Influence Measures and Diagnostic Plots for Multivariate Linear Models">
<meta property="og:description" content="Computes regression deletion diagnostics for multivariate linear models and provides some associated
	diagnostic plots.  The diagnostic measures include hat-values (leverages), generalized Cooks distance, and
	generalized squared studentized' residuals.  Several types of plots to detect influential observations are
	provided.">
<meta property="og:image" content="http://friendly.github.io/mvinfluence/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">mvinfluence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/uni-vs-multi.html">Univariate versus Multivariate Influence</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/mvinfluence/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="mvinfluence-">mvinfluence <a class="anchor" aria-label="anchor" href="#mvinfluence-"></a>
</h1>
</div>
<p><strong>Influence Measures and Diagnostic Plots for Multivariate Linear Models</strong></p>
<p>Version 0.9-1</p>
<p>Functions in this package compute regression deletion diagnostics for multivariate linear models following methods proposed by Barrett &amp; Ling (1992) and provide some associated diagnostic plots. The diagnostic measures include hat-values (leverages), generalized Cook’s distance, and generalized squared ‘studentized’ residuals. Several types of plots to detect influential observations are provided.</p>
<p>In addition, the functions provide diagnostics for deletion of subsets of observations of size <code>m&gt;1</code>. This case is theoretically interesting because sometimes pairs (<code>m=2</code>) of influential observations can mask each other, sometimes they can have joint influence far exceeding their individual effects, as well as other interesting phenomena described by Lawrence (1995). Associated methods for the case <code>m&gt;1</code> are still under development in this package.</p>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>Documentation for the package is now available at <a href="https://friendly.github.io/mvinfluence/" class="external-link uri">https://friendly.github.io/mvinfluence/</a>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Get the released CRAN version or this development version:</p>
<table class="table">
<colgroup>
<col width="29%">
<col width="70%">
</colgroup>
<tbody>
<tr class="odd">
<td>CRAN version</td>
<td><code>install.packages("mvinfluence")</code></td>
</tr>
<tr class="even">
<td>Development version</td>
<td><code>remotes::install_github("friendly/mvinfluence")</code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="goals">Goals<a class="anchor" aria-label="anchor" href="#goals"></a>
</h2>
<p>The design goal for this package is that, as an extension of standard methods for univariate linear models, you should be able to fit a linear model with a <strong>multivariate</strong> response,</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mymlm <span class="ot">&lt;-</span> <span class="fu">lm</span>( <span class="fu">cbind</span>(y1, y2, y3) <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data=</span>mydata)</span></code></pre></div>
<p>and then get useful diagnostics and plots with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">influence</span>(mymlm)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hatvalues</span>(mymlm)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cooks.distance</span>(mymlm)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(mymlm, ...)  </span></code></pre></div>
<p>As is done in comparable univariate functions in the <code>car</code> package, <em>noteworthy</em> points are identified in printed output and graphs.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>The <code>Rohwer</code> data contains data on kindergarten children designed to examine how well performance on a set of paired-associate (PA) learning tasks can predict performance on some measures of aptitude and achievement— <code>SAT</code> (a scholastic aptitude test), <code>PPVT</code> (Peabody Picture Vocabulary Test), and <code>Raven</code> ( Raven Progressive Matrices Test). The PA tasks differ in how the stimulus item was presented: <code>n</code> (named), <code>s</code> (still), <code>ns</code> (named still), <code>na</code> (named action) and <code>ss</code> (sentence still).</p>
<p>Here, we fit a MLM to a subset of the Rohwer data (the Low SES group).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Rohwer</span>, package<span class="op">=</span><span class="st">"heplots"</span><span class="op">)</span></span>
<span><span class="va">Rohwer2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Rohwer</span>, subset<span class="op">=</span><span class="va">group</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Rohwer2</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Rohwer2</span><span class="op">)</span></span>
<span><span class="va">Rohwer.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">SAT</span>, <span class="va">PPVT</span>, <span class="va">Raven</span><span class="op">)</span> <span class="op">~</span> <span class="va">n</span> <span class="op">+</span> <span class="va">s</span> <span class="op">+</span> <span class="va">ns</span> <span class="op">+</span> <span class="va">na</span> <span class="op">+</span> <span class="va">ss</span>, data<span class="op">=</span><span class="va">Rohwer2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">Rohwer.mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;    Df test stat approx F num Df den Df Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; n   1     0.202     2.02      3     24 0.1376   </span></span>
<span><span class="co">#&gt; s   1     0.310     3.59      3     24 0.0284 * </span></span>
<span><span class="co">#&gt; ns  1     0.358     4.46      3     24 0.0126 * </span></span>
<span><span class="co">#&gt; na  1     0.465     6.96      3     24 0.0016 **</span></span>
<span><span class="co">#&gt; ss  1     0.089     0.78      3     24 0.5173   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<div class="section level3">
<h3 id="influence-plots">Influence plots<a class="anchor" aria-label="anchor" href="#influence-plots"></a>
</h3>
<p>The default influence plot (<code>type="stres"</code>) shows the squared standardized residual against the Hat value. The areas of the circles representing the observations are proportional to generalized Cook’s distances.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">infl</span> <span class="op">&lt;-</span><span class="fu">influencePlot</span><span class="op">(</span><span class="va">Rohwer.mod</span>, id.n<span class="op">=</span><span class="fl">4</span>, type <span class="op">=</span> <span class="st">"stres"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-rohwer2-1.png"><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        H      Q  CookD     L      R</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  0.568 0.3439 0.8467 1.316 0.7964</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 0.452 0.0324 0.0634 0.824 0.0591</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14 0.126 0.2997 0.1643 0.145 0.3431</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15 0.332 0.0105 0.0152 0.498 0.0158</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 25 0.157 0.3820 0.2601 0.186 0.4532</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27 0.367 0.2128 0.3387 0.580 0.3363</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29 0.304 0.2295 0.3026 0.437 0.3299</span></span></code></pre></div>
<p>As you can see above, the function returns a data frame of the influence statistics for the identified points. “Noteworthy” points are those that are unusual on <em>either</em> Hat value (H) or the squared studentized residual (Q), so more points will be shown than the <code>id.n</code> value. It is often more useful to sort these in descending order by one of the influence measures.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infl</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">H</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        H      Q  CookD     L      R</span></span>
<span><span class="co">#&gt; 5  0.568 0.3439 0.8467 1.316 0.7964</span></span>
<span><span class="co">#&gt; 10 0.452 0.0324 0.0634 0.824 0.0591</span></span>
<span><span class="co">#&gt; 27 0.367 0.2128 0.3387 0.580 0.3363</span></span>
<span><span class="co">#&gt; 15 0.332 0.0105 0.0152 0.498 0.0158</span></span>
<span><span class="co">#&gt; 29 0.304 0.2295 0.3026 0.437 0.3299</span></span>
<span><span class="co">#&gt; 25 0.157 0.3820 0.2601 0.186 0.4532</span></span>
<span><span class="co">#&gt; 14 0.126 0.2997 0.1643 0.145 0.3431</span></span></code></pre></div>
<p>An alternative (<code>type="LR"</code>) plots residual components against leverage components, both on log scales. Because influence is a product of residual <span class="math inline">×</span> Leverage, this plot had the property that contours of constant Cook’s distance fall on diagonal lines with slope = -1. Each successive dashed line represents a <strong>multiple</strong> of Cook’s D. This plot is often easier to read than the standard version.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">influencePlot</span><span class="op">(</span><span class="va">Rohwer.mod</span>, id.n<span class="op">=</span><span class="fl">4</span>, type<span class="op">=</span><span class="st">"LR"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-rohwer3-1.png"><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        H      Q  CookD     L      R</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  0.568 0.3439 0.8467 1.316 0.7964</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 0.452 0.0324 0.0634 0.824 0.0591</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14 0.126 0.2997 0.1643 0.145 0.3431</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15 0.332 0.0105 0.0152 0.498 0.0158</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 25 0.157 0.3820 0.2601 0.186 0.4532</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27 0.367 0.2128 0.3387 0.580 0.3363</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29 0.304 0.2295 0.3026 0.437 0.3299</span></span></code></pre></div>
<p>We observe that case 5 has the largest leverage and it is highly influential. Case 25 has the largest residual component and middling leverage, so it is moderately influential. Cases 14, 29, 27 have nearly identical residuals, and their influence increases from left to right with leverage.</p>
</div>
<div class="section level3">
<h3 id="index-plots">Index plots<a class="anchor" aria-label="anchor" href="#index-plots"></a>
</h3>
<p>If you wish to see how the observations fare on each of the the measures (as well as Mahalanobis <span class="math inline"><em>D</em><sup>2</sup></span> of the residuals from the origin), the <code>inflIndexPlot()</code> function gives you index plots.</p>
<p>There are extensive options for identifying and labeling “noteworthy” observations, with various methods. These rely on <code><a href="https://rdrr.io/pkg/car/man/showLabels.html" class="external-link">car::showLabels()</a></code>, where the default <code>id.method = "y"</code> label points whose Y coordinate is very large.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">infIndexPlot</span><span class="op">(</span><span class="va">Rohwer.mod</span>, </span>
<span>             id.n<span class="op">=</span><span class="fl">3</span>, id.col <span class="op">=</span> <span class="st">"red"</span>, id.cex<span class="op">=</span><span class="fl">1.5</span>, id.location<span class="op">=</span><span class="st">"ab"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-indexplot-1.png"><!-- --></p>
<p>In this example, note that while case 5 stands out as influential, it does not have an exceptionally large Mahalanobis squared distance, <span class="math inline"><em>D</em><sup>2</sup></span> of the residuals.</p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="robust-mlms">Robust MLMs<a class="anchor" aria-label="anchor" href="#robust-mlms"></a>
</h1>
<p>Influential cases and those with large residuals can sometimes be dealt with by fitting a <strong>robust</strong> version of the multivariate model. The function <code><a href="http://friendly.github.io/heplots/reference/robmlm.html" class="external-link">heplots::robmlm()</a></code> uses a simple M-estimator that down-weights cases with large residuals. Fitting is done by iterated re-weighted least squares (IWLS), using weights based on the Mahalanobis squared distances of the current residuals from the origin, and a scaling (covariance) matrix calculated by <code><a href="https://rdrr.io/pkg/MASS/man/cov.trob.html" class="external-link">MASS::cov.trob()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Rohwer.rmod</span> <span class="op">&lt;-</span> <span class="fu">heplots</span><span class="fu">::</span><span class="fu"><a href="http://friendly.github.io/heplots/reference/robmlm.html" class="external-link">robmlm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">SAT</span>, <span class="va">PPVT</span>, <span class="va">Raven</span><span class="op">)</span> <span class="op">~</span> <span class="va">n</span> <span class="op">+</span> <span class="va">s</span> <span class="op">+</span> <span class="va">ns</span> <span class="op">+</span> <span class="va">na</span> <span class="op">+</span> <span class="va">ss</span>, </span>
<span>                               data<span class="op">=</span><span class="va">Rohwer2</span><span class="op">)</span></span></code></pre></div>
<p>The returned object has a <code>weights</code> component, the weight for each case in the final iteration. Which ones are less than 0.9 here?</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Rohwer.rmod</span><span class="op">$</span><span class="va">weights</span> <span class="op">&lt;</span> <span class="fl">.9</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 14 21 25 31</span></span></code></pre></div>
<p>A simple index plot makes the down-weighted observations stand out. Case 5 is not among them, but I label it anyway.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="va">wts</span> <span class="op">&lt;-</span> <span class="va">Rohwer.rmod</span><span class="op">$</span><span class="va">weights</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">wts</span> <span class="op">&lt;</span> <span class="fl">.9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wts</span>, type<span class="op">=</span><span class="st">"h"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Case index"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"Robust mlm weight"</span>,</span>
<span>     cex.lab <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.9</span>, <span class="fl">33</span>, <span class="fl">1.1</span>, </span>
<span>     col<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="fl">.25</span><span class="op">)</span>, </span>
<span>     border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">wts</span>, pch <span class="op">=</span> <span class="fl">16</span>, </span>
<span>       cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">wts</span> <span class="op">&lt;</span> <span class="fl">.9</span>, <span class="fl">1.5</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">wts</span> <span class="op">&lt;</span> <span class="fl">.9</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">idx</span>, <span class="va">wts</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span>, label<span class="op">=</span><span class="va">idx</span>, pos<span class="op">=</span><span class="fl">3</span>, cex<span class="op">=</span><span class="fl">1.2</span>, xpd<span class="op">=</span><span class="cn">NA</span> <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-rob-index-plot-1.png"><!-- --></p>
<p>What’s up with case 5? It had the largest leverage, but it’s Mahalanobis <span class="math inline"><em>D</em><sup>2</sup></span> was not large. Thus, it was not down-weighted, even though it is an influential observation.</p>
<p>What difference do these observations make in the fitted regression? This calculates the percentage relative difference between the coefficients in the standard <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> and the robust version. The largest changes are for the coefficients of the <code>ss</code> task, but there is an even greater one for <code>PPVT</code> on the <code>n</code> task.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Rohwer.mod</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Rohwer.rmod</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Rohwer.mod</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                SAT  PPVT  Raven</span></span>
<span><span class="co">#&gt; (Intercept)  1.001  1.27  0.755</span></span>
<span><span class="co">#&gt; n            4.001 36.32  3.874</span></span>
<span><span class="co">#&gt; s            1.195 13.01  0.401</span></span>
<span><span class="co">#&gt; ns           0.152 15.68 14.771</span></span>
<span><span class="co">#&gt; na           1.560  2.26  6.913</span></span>
<span><span class="co">#&gt; ss          15.173 26.55 21.288</span></span></code></pre></div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>To cite <code>mvinfluence</code> in publications, use:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"mvinfluence"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To cite package 'mvinfluence' in publications use:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Friendly M (2022). _mvinfluence: Influence Measures and Diagnostic</span></span>
<span><span class="co">#&gt;   Plots for Multivariate Linear Models_. R package version 0.9.0,</span></span>
<span><span class="co">#&gt;   &lt;https://github.com/friendly/mvinfluence&gt;.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   @Manual{,</span></span>
<span><span class="co">#&gt;     title = {mvinfluence: Influence Measures and Diagnostic Plots for Multivariate Linear Models},</span></span>
<span><span class="co">#&gt;     author = {Michael Friendly},</span></span>
<span><span class="co">#&gt;     year = {2022},</span></span>
<span><span class="co">#&gt;     note = {R package version 0.9.0},</span></span>
<span><span class="co">#&gt;     url = {https://github.com/friendly/mvinfluence},</span></span>
<span><span class="co">#&gt;   }</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Barrett, B. E. and Ling, R. F. (1992). General Classes of Influence Measures for Multivariate Regression. <em>Journal of the American Statistical Association</em>, <strong>87</strong>(417), 184-191.</p>
<p>Barrett, B. E. (2003). Understanding Influence in Multivariate Regression. <em>Communications in Statistics – Theory and Methods</em>, <strong>32</strong>, 3, 667-680.</p>
<p>Lawrence, A. J. (1995). Deletion Influence and Masking in Regression. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em> , <strong>57</strong>, No. 1, pp. 181-189.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=mvinfluence" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/friendly/mvinfluence/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/friendly/mvinfluence/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2" class="external-link">GPL-2</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mvinfluence</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Michael Friendly <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3237-0941" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=mvinfluence" class="external-link"><img src="http://www.r-pkg.org/badges/version/mvinfluence" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://cran.r-project.org/package=mvinfluence" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/mvinfluence"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/128774860" class="external-link"><img src="https://zenodo.org/badge/128774860.svg" alt="DOI"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
